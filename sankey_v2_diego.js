!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.sankey_v2=n():t.sankey_v2=n()}(self,(()=>(()=>{"use strict";var t,n={};function e(t,n){return t<n?-1:n<t?1:n<=t?0:NaN}function r(t,n){var e,r,i=t.length,a=-1;if(null==n){for(;++a<i;)if(null!=(e=t[a])&&e<=e)for(r=e;++a<i;)null!=(e=t[a])&&r<e&&(r=e)}else for(;++a<i;)if(null!=(e=n(t[a],a,t))&&e<=e)for(r=e;++a<i;)null!=(e=n(t[a],a,t))&&r<e&&(r=e);return r}function i(t,n){var e,r=t.length,i=-1,a=0;if(null==n)for(;++i<r;)(e=+t[i])&&(a+=e);else for(;++i<r;)(e=+n(t[i],i,t))&&(a+=e);return a}(m={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}).r(n),1===(m=e).length&&(t=m,m=function(n,r){return e(t(n),r)}),(m=Array.prototype).slice,m.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2),Array.prototype.slice;var a={value:function(){}};function o(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new s(r)}function s(t){this._=t}function u(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=a,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}s.prototype=o.prototype={constructor:s,on:function(t,n){var e,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");if(0<=e&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<s;)if(e=(t=a[o]).type)i[e]=u(i[e],t.name,n);else if(null==n)for(e in i)i[e]=u(i[e],t.name,null);return this}for(;++o<s;)if(e=(e=(t=a[o]).type)&&function(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}(i[e],t.name))return e},copy:function(){var t,n={},e=this._;for(t in e)n[t]=e[t].slice();return new s(n)},call:function(t,n){if(0<(e=arguments.length-2))for(var e,r,i=new Array(e),a=0;a<e;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,e=(r=this._[t]).length;a<e;++a)r[a].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};const c=o;var f="http://www.w3.org/1999/xhtml";const l={svg:"http://www.w3.org/2000/svg",xhtml:f,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function h(t){var n=t+="",e=n.indexOf(":");return 0<=e&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),l.hasOwnProperty(n)?{space:l[n],local:t}:t}function d(t){return((t=h(t)).local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===f&&n.documentElement.namespaceURI===f?n.createElement(t):n.createElementNS(e,t)}})(t)}function p(){}function _(t){return null==t?p:function(){return this.querySelector(t)}}function g(){return[]}function y(t){return null==t?g:function(){return this.querySelectorAll(t)}}var v,m=function(t){return function(){return this.matches(t)}};"undefined"==typeof document||(it=document.documentElement).matches||(v=it.webkitMatchesSelector||it.msMatchesSelector||it.mozMatchesSelector||it.oMatchesSelector,m=function(t){return function(){return v.call(this,t)}});const b=m;function x(t){return new Array(t.length)}function w(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function M(t,n,e,r,i,a){for(var o,s=0,u=n.length,c=a.length;s<c;++s)(o=n[s])?(o.__data__=a[s],r[s]=o):e[s]=new w(t,a[s]);for(;s<u;++s)(o=n[s])&&(i[s]=o)}function T(t,n,e,r,i,a,o){for(var s,u,c={},f=n.length,l=a.length,h=new Array(f),d=0;d<f;++d)(s=n[d])&&(h[d]=u="$"+o.call(s,s.__data__,d,n),u in c?i[d]=s:c[u]=s);for(d=0;d<l;++d)(s=c[u="$"+o.call(t,a[d],d,a)])?((r[d]=s).__data__=a[d],c[u]=null):e[d]=new w(t,a[d]);for(d=0;d<f;++d)(s=n[d])&&c[h[d]]===s&&(i[d]=s)}function A(t,n){return t<n?-1:n<t?1:n<=t?0:NaN}function E(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function C(t,n){return t.style.getPropertyValue(n)||E(t).getComputedStyle(t,null).getPropertyValue(n)}function S(t){return t.trim().split(/^|\s+/)}function k(t){return t.classList||new N(t)}function N(t){this._node=t,this._names=S(t.getAttribute("class")||"")}function D(t,n){for(var e=k(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function L(t,n){for(var e=k(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function P(){this.textContent=""}function U(){this.innerHTML=""}function O(){this.nextSibling&&this.parentNode.appendChild(this)}function H(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function R(){return null}function F(){var t=this.parentNode;t&&t.removeChild(this)}function I(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Y(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}w.prototype={constructor:w,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},N.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){0<=(t=this._names.indexOf(t))&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};var B={},q=null;function G(t,n,e){return t=z(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function z(t,n,e){return function(r){var i=q;q=r;try{t.call(this,this.__data__,n,e)}finally{q=i}}}function j(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,a=n.length;r<a;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function X(t,n,e){var r=B.hasOwnProperty(t.type)?G:z;return function(i,a,o){var s,u=this.__on,c=r(n,a,o);if(u)for(var f=0,l=u.length;f<l;++f)if((s=u[f]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=e),void(s.value=n);this.addEventListener(t.type,c,e),s={type:t.type,name:t.name,value:n,listener:c,capture:e},u?u.push(s):this.__on=[s]}}function V(t,n,e){var r=E(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}"undefined"==typeof document||"onmouseenter"in document.documentElement||(B={mouseenter:"mouseover",mouseleave:"mouseout"});var Z=[null];function $(t,n){this._groups=t,this._parents=n}function W(){return new $([[document.documentElement]],Z)}$.prototype=W.prototype={constructor:$,select:function(t){"function"!=typeof t&&(t=_(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o,s=n[i],u=s.length,c=r[i]=new Array(u),f=0;f<u;++f)(a=s[f])&&(o=t.call(a,a.__data__,f,s))&&("__data__"in a&&(o.__data__=a.__data__),c[f]=o);return new $(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=y(t));for(var n=this._groups,e=n.length,r=[],i=[],a=0;a<e;++a)for(var o,s=n[a],u=s.length,c=0;c<u;++c)(o=s[c])&&(r.push(t.call(o,o.__data__,c,s)),i.push(o));return new $(r,i)},filter:function(t){"function"!=typeof t&&(t=b(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o=n[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&u.push(a);return new $(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),f=-1,this.each((function(t){p[++f]=t})),p;var e,r=n?T:M,i=this._parents,a=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var o=a.length,s=new Array(o),u=new Array(o),c=new Array(o),f=0;f<o;++f){var l=i[f],h=a[f],d=h.length,p=t.call(l,l&&l.__data__,f,i),_=p.length,g=u[f]=new Array(_),y=s[f]=new Array(_);r(l,h,g,y,c[f]=new Array(d),p,n);for(var v,m,b=0,x=0;b<_;++b)if(v=g[b]){for(x<=b&&(x=b+1);!(m=y[x])&&++x<_;);v._next=m||null}}return(s=new $(s,i))._enter=u,s._exit=c,s},enter:function(){return new $(this._enter||this._groups.map(x),this._parents)},exit:function(){return new $(this._exit||this._groups.map(x),this._parents)},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=(t=e.length,Math.min(r,t)),a=new Array(r),o=0;o<i;++o)for(var s,u=n[o],c=e[o],f=u.length,l=a[o]=new Array(f),h=0;h<f;++h)(s=u[h]||c[h])&&(l[h]=s);for(;o<r;++o)a[o]=n[o];return new $(a,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],a=i.length-1,o=i[a];0<=--a;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t=t||A;for(var e=this._groups,r=e.length,i=new Array(r),a=0;a<r;++a){for(var o,s=e[a],u=s.length,c=i[a]=new Array(u),f=0;f<u;++f)(o=s[f])&&(c[f]=o);c.sort(n)}return new $(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,a=n[e],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,n){var e;return t=h(t),arguments.length<2?(e=this.node(),t.local?e.getAttributeNS(t.space,t.local):e.getAttribute(t)):this.each((null==n?t.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof n?t.local?function(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}:function(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}:t.local?function(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}:function(t,n){return function(){this.setAttribute(t,n)}})(t,n))},style:function(t,n,e){return 1<arguments.length?this.each((null==n?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof n?function(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}:function(t,n,e){return function(){this.style.setProperty(t,n,e)}})(t,n,null==e?"":e)):C(this.node(),t)},property:function(t,n){return 1<arguments.length?this.each((null==n?function(t){return function(){delete this[t]}}:"function"==typeof n?function(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}:function(t,n){return function(){this[t]=n}})(t,n)):this.node()[t]},classed:function(t,n){var e=S(t+"");if(arguments.length<2){for(var r=k(this.node()),i=-1,a=e.length;++i<a;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?function(t,n){return function(){(n.apply(this,arguments)?D:L)(this,t)}}:n?function(t){return function(){D(this,t)}}:function(t){return function(){L(this,t)}})(e,n))},text:function(t){return arguments.length?this.each(null==t?P:("function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?U:("function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(O)},lower:function(){return this.each(H)},append:function(t){var n="function"==typeof t?t:d(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:d(t),r=null==n?R:"function"==typeof n?n:_(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(F)},clone:function(t){return this.select(t?Y:I)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,a=(t+"").trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return 0<=e&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}})),o=a.length;if(!(arguments.length<2)){for(s=n?X:j,null==e&&(e=!1),r=0;r<o;++r)this.each(s(a[r],n,e));return this}var s=this.node().__on;if(s)for(var u,c=0,f=s.length;c<f;++c)for(r=0,u=s[c];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,n){return this.each(("function"==typeof n?function(t,n){return function(){return V(this,t,n.apply(this,arguments))}}:function(t,n){return function(){return V(this,t,n)}})(t,n))}};const K=W;function Q(t){return"string"==typeof t?new $([[document.querySelector(t)]],[document.documentElement]):new $([[t]],Z)}function J(t){var n,e=function(){for(var t,n=q;t=n.sourceEvent;)n=t;return n}();return e.changedTouches&&(e=e.changedTouches[0]),(n=t.ownerSVGElement||t).createSVGPoint?((n=n.createSVGPoint()).x=e.clientX,n.y=e.clientY,[(n=n.matrixTransform(t.getScreenCTM().inverse())).x,n.y]):(n=t.getBoundingClientRect(),[e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop])}function tt(t,n,e){(t.prototype=n.prototype=e).constructor=t}function nt(t,n){var e,r=Object.create(t.prototype);for(e in n)r[e]=n[e];return r}function et(){}var rt=1/.7,it="\\s*([+-]?\\d+)\\s*",at=(m="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*","\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*"),ot=/^#([0-9a-f]{3})$/,st=/^#([0-9a-f]{6})$/,ut=new RegExp("^rgb\\("+[it,it,it]+"\\)$"),ct=new RegExp("^rgb\\("+[at,at,at]+"\\)$"),ft=new RegExp("^rgba\\("+[it,it,it,m]+"\\)$"),lt=new RegExp("^rgba\\("+[at,at,at,m]+"\\)$"),ht=new RegExp("^hsl\\("+[m,at,at]+"\\)$"),dt=new RegExp("^hsla\\("+[m,at,at,m]+"\\)$"),pt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _t(t){var n;return t=(t+"").trim().toLowerCase(),(n=ot.exec(t))?new bt((n=parseInt(n[1],16))>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):(n=st.exec(t))?gt(parseInt(n[1],16)):(n=ut.exec(t))?new bt(n[1],n[2],n[3],1):(n=ct.exec(t))?new bt(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=ft.exec(t))?yt(n[1],n[2],n[3],n[4]):(n=lt.exec(t))?yt(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=ht.exec(t))?xt(n[1],n[2]/100,n[3]/100,1):(n=dt.exec(t))?xt(n[1],n[2]/100,n[3]/100,n[4]):pt.hasOwnProperty(t)?gt(pt[t]):"transparent"===t?new bt(NaN,NaN,NaN,0):null}function gt(t){return new bt(t>>16&255,t>>8&255,255&t,1)}function yt(t,n,e,r){return new bt(t=r<=0?n=e=NaN:t,n,e,r)}function vt(t){return(t=t instanceof et?t:_t(t))?new bt((t=t.rgb()).r,t.g,t.b,t.opacity):new bt}function mt(t,n,e,r){return 1===arguments.length?vt(t):new bt(t,n,e,null==r?1:r)}function bt(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function xt(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||1<=e?t=n=NaN:n<=0&&(t=NaN),new Mt(t,n,e,r)}function wt(t,n,e,r){return 1===arguments.length?(i=t)instanceof Mt?new Mt(i.h,i.s,i.l,i.opacity):(i=i instanceof et?i:_t(i))?i instanceof Mt?i:(a=(i=i.rgb()).r/255,o=i.g/255,s=i.b/255,u=Math.min(a,o,s),f=NaN,h=((c=Math.max(a,o,s))+u)/2,(l=c-u)?(f=a===c?(o-s)/l+6*(o<s):o===c?(s-a)/l+2:(a-o)/l+4,l/=h<.5?c+u:2-c-u,f*=60):l=0<h&&h<1?0:f,new Mt(f,l,h,i.opacity)):new Mt:new Mt(t,n,e,null==r?1:r);var i,a,o,s,u,c,f,l,h}function Mt(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Tt(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}tt(et,_t,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),tt(bt,mt,nt(et,{brighter:function(t){return t=null==t?rt:Math.pow(rt,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),tt(Mt,wt,nt(et,{brighter:function(t){return t=null==t?rt:Math.pow(rt,t),new Mt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Mt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t,n=this.h%360+360*(this.h<0),e=isNaN(n)||isNaN(this.s)?0:this.s;return new bt(Tt(240<=n?n-240:120+n,t=2*(t=this.l)-(e=t+(t<.5?t:1-t)*e),e),Tt(n,t,e),Tt(n<120?240+n:n-120,t,e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var At=Math.PI/180,Et=180/Math.PI,Ct=.95047,St=1,kt=1.08883,Nt=4/29,Dt=6/29,Lt=3*Dt*Dt,Pt=Dt*Dt*Dt;function Ut(t){var n,e,r,i,a;return t instanceof Ot?new Ot(t.l,t.a,t.b,t.opacity):t instanceof Bt?(n=t.h*At,new Ot(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)):(i=Ht((.4124564*(n=It((t=t instanceof bt?t:vt(t)).r))+.3575761*(e=It(t.g))+.1804375*(r=It(t.b)))/Ct),new Ot(116*(a=Ht((.2126729*n+.7151522*e+.072175*r)/St))-16,500*(i-a),200*(a-Ht((.0193339*n+.119192*e+.9503041*r)/kt)),t.opacity))}function Ot(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function Ht(t){return Pt<t?Math.pow(t,1/3):t/Lt+Nt}function Rt(t){return Dt<t?t*t*t:Lt*(t-Nt)}function Ft(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function It(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Yt(t,n,e,r){return 1!==arguments.length?new Bt(t,n,e,null==r?1:r):(n=t)instanceof Bt?new Bt(n.h,n.c,n.l,n.opacity):(n instanceof Ot||(n=Ut(n)),new Bt((e=Math.atan2(n.b,n.a)*Et)<0?360+e:e,Math.sqrt(n.a*n.a+n.b*n.b),n.l,n.opacity))}function Bt(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}tt(Ot,(function(t,n,e,r){return 1===arguments.length?Ut(t):new Ot(t,n,e,null==r?1:r)}),nt(et,{brighter:function(t){return new Ot(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Ot(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return t=St*Rt(t),new bt(Ft(3.2404542*(n=Ct*Rt(n))-1.5371385*t-.4985314*(e=kt*Rt(e))),Ft(-.969266*n+1.8760108*t+.041556*e),Ft(.0556434*n-.2040259*t+1.0572252*e),this.opacity)}})),tt(Bt,Yt,nt(et,{brighter:function(t){return new Bt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Bt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Ut(this).rgb()}}));var qt=1.78277,Gt=-.29227,zt=-.90649,jt=1.97294,Xt=jt*zt,Vt=jt*qt,Zt=qt*Gt- -.14861*zt;function $t(t,n,e,r){return 1===arguments.length?(i=t)instanceof Wt?new Wt(i.h,i.s,i.l,i.opacity):(a=(i=i instanceof bt?i:vt(i)).r/255,o=i.g/255,u=i.b/255,u=(jt*(o-(a=(Zt*u+Xt*a-Vt*o)/(Zt+Xt-Vt)))-Gt*(o=u-a))/zt,new Wt((u=(s=Math.sqrt(u*u+o*o)/(jt*a*(1-a)))?Math.atan2(u,o)*Et-120:NaN)<0?u+360:u,s,a,i.opacity)):new Wt(t,n,e,null==r?1:r);var i,a,o,s,u}function Wt(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Kt(t,n,e,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*n+(4-6*a+3*o)*e+(1+3*t+3*a-3*o)*r+o*i)/6}function Qt(t){return function(){return t}}function Jt(t,n){return function(e){return t+e*n}}function tn(t,n){var e=n-t;return e?Jt(t,180<e||e<-180?e-360*Math.round(e/360):e):Qt(isNaN(t)?n:t)}function nn(t,n){var e=n-t;return e?Jt(t,e):Qt(isNaN(t)?n:t)}tt(Wt,$t,nt(et,{brighter:function(t){return t=null==t?rt:Math.pow(rt,t),new Wt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Wt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*At,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t);return t=Math.sin(t),new bt(255*(n+e*(-.14861*r+qt*t)),255*(n+e*(Gt*r+zt*t)),255*(n+jt*r*e),this.opacity)}}));const en=function t(n){var e=function(t){return 1==(t=+t)?nn:function(n,e){return e-n?(r=n,i=e,a=t,r=Math.pow(r,a),i=Math.pow(i,a)-r,a=1/a,function(t){return Math.pow(r+t*i,a)}):Qt(isNaN(n)?e:n);var r,i,a}}(n);function r(t,n){var r=e((t=mt(t)).r,(n=mt(n)).r),i=e(t.g,n.g),a=e(t.b,n.b),o=nn(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=a(n),t.opacity=o(n),t+""}}return r.gamma=t,r}(1);function rn(t){return function(n){for(var e,r=n.length,i=new Array(r),a=new Array(r),o=new Array(r),s=0;s<r;++s)e=mt(n[s]),i[s]=e.r||0,a[s]=e.g||0,o[s]=e.b||0;return i=t(i),a=t(a),o=t(o),e.opacity=1,function(t){return e.r=i(t),e.g=a(t),e.b=o(t),e+""}}}function an(t,n){return n-=t=+t,function(e){return t+n*e}}rn((function(t){var n=t.length-1;return function(e){var r=e<=0?e=0:1<=e?n-(e=1):Math.floor(e*n),i=t[r],a=t[r+1],o=0<r?t[r-1]:2*i-a,s=r<n-1?t[r+2]:2*a-i;return Kt((e-r/n)*n,o,i,a,s)}})),rn((function(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],a=t[r%n],o=t[(r+1)%n],s=t[(r+2)%n];return Kt((e-r/n)*n,i,a,o,s)}}));var on,sn,un,cn,fn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ln=new RegExp(fn.source,"g"),hn=180/Math.PI,dn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pn(t,n,e,r,i,a){var o,s,u;return(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o),(u=t*e+n*r)&&(e-=t*u,r-=n*u),(s=Math.sqrt(e*e+r*r))&&(e/=s,r/=s,u/=s),t*r<n*e&&(t=-t,n=-n,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(n,t)*hn,skewX:Math.atan(u)*hn,scaleX:o,scaleY:s}}function _n(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s,u,c,f,l,h,d,p,_=[],g=[];return a=t(a),o=t(o),c=a.translateX,f=a.translateY,d=o.translateX,h=o.translateY,l=_,u=g,c!==d||f!==h?(s=l.push("translate(",null,n,null,e),u.push({i:s-4,x:an(c,d)},{i:s-2,x:an(f,h)})):(d||h)&&l.push("translate("+d+n+h+e),u=a.rotate,c=o.rotate,s=_,f=g,u!==c?(180<u-c?c+=360:180<c-u&&(u+=360),f.push({i:s.push(i(s)+"rotate(",null,r)-2,x:an(u,c)})):c&&s.push(i(s)+"rotate("+c+r),l=a.skewX,d=o.skewX,h=_,f=g,l!==d?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:an(l,d)}):d&&h.push(i(h)+"skewX("+d+r),u=a.scaleX,c=a.scaleY,f=o.scaleX,l=o.scaleY,h=_,d=g,u!==f||c!==l?(p=h.push(i(h)+"scale(",null,",",null,")"),d.push({i:p-4,x:an(u,f)},{i:p-2,x:an(c,l)})):1===f&&1===l||h.push(i(h)+"scale("+f+","+l+")"),a=o=null,function(t){for(var n,e=-1,r=g.length;++e<r;)_[(n=g[e]).i]=n.x(t);return _.join("")}}}var gn=_n((function(t){return"none"===t?dn:(on||(on=document.createElement("DIV"),sn=document.documentElement,un=document.defaultView),on.style.transform=t,t=un.getComputedStyle(sn.appendChild(on),null).getPropertyValue("transform"),sn.removeChild(on),pn(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),yn=_n((function(t){return null!=t&&((cn=cn||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",t),t=cn.transform.baseVal.consolidate())?pn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):dn}),", ",")",")");function vn(t){return function(n,e){var r=t((n=wt(n)).h,(e=wt(e)).h),i=nn(n.s,e.s),a=nn(n.l,e.l),o=nn(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=a(t),n.opacity=o(t),n+""}}}function mn(t){return function(n,e){var r=t((n=Yt(n)).h,(e=Yt(e)).h),i=nn(n.c,e.c),a=nn(n.l,e.l),o=nn(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=a(t),n.opacity=o(t),n+""}}}function bn(t){return function n(e){function r(n,r){var i=t((n=$t(n)).h,(r=$t(r)).h),a=nn(n.s,r.s),o=nn(n.l,r.l),s=nn(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=a(t),n.l=o(Math.pow(t,e)),n.opacity=s(t),n+""}}return e=+e,r.gamma=n,r}(1)}Math.SQRT2,vn(tn),vn(nn),mn(tn),mn(nn),bn(tn),it=bn(nn);var xn,wn,Mn=0,Tn=0,An=0,En=1e3,Cn=0,Sn=0,kn=0,Nn="object"==typeof performance&&performance.now?performance:Date,Dn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ln(){return Sn||(Dn(Pn),Sn=Nn.now()+kn)}function Pn(){Sn=0}function Un(){this._call=this._time=this._next=null}function On(t,n,e){var r=new Un;return r.restart(t,n,e),r}function Hn(){Sn=(Cn=Nn.now())+kn,Mn=Tn=0;try{Ln(),++Mn;for(var t,n=xn;n;)0<=(t=Sn-n._time)&&n._call.call(null,t),n=n._next;--Mn}finally{for(var e,r,i=xn,a=1/(Mn=0);i;)i=i._call?(a>i._time&&(a=i._time),(e=i)._next):(r=i._next,i._next=null,e?e._next=r:xn=r);wn=e,Fn(a),Sn=0}}function Rn(){var t=Nn.now(),n=t-Cn;En<n&&(kn-=n,Cn=t)}function Fn(t){Mn||(Tn=Tn&&clearTimeout(Tn),24<t-Sn?(t<1/0&&(Tn=setTimeout(Hn,t-Nn.now()-kn)),An=An&&clearInterval(An)):(An||(Cn=Nn.now(),An=setInterval(Rn,En)),Mn=1,Dn(Hn)))}function In(t,n,e){var r=new Un;return n=null==n?0:+n,r.restart((function(e){r.stop(),t(e+n)}),n,e),r}Un.prototype=On.prototype={constructor:Un,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?Ln():+e)+(null==n?0:+n),this._next||wn===this||(wn?wn._next=this:xn=this,wn=this),this._call=t,this._time=e,Fn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fn())}};var Yn=c("start","end","interrupt"),Bn=[],qn=2;function Gn(t,n,e,r,i,a){var o,s,u,c,f,l=t.__transition;if(l){if(e in l)return}else t.__transition={};function h(t){var n,e,r,i;if(1!==u.state)return p();for(n in f)if((i=f[n]).name===u.name){if(3===i.state)return In(h);4===i.state?(i.state=6,i.timer.stop(),i.on.call("interrupt",o,o.__data__,i.index,i.group),delete f[n]):+n<s&&(i.state=6,i.timer.stop(),delete f[n])}if(In((function(){3===u.state&&(u.state=4,u.timer.restart(d,u.delay,u.time),d(t))})),u.state=qn,u.on.call("start",o,o.__data__,u.index,u.group),u.state===qn){for(u.state=3,c=new Array(r=u.tween.length),n=0,e=-1;n<r;++n)(i=u.tween[n].value.call(o,o.__data__,u.index,u.group))&&(c[++e]=i);c.length=e+1}}function d(t){for(var n=t<u.duration?u.ease.call(null,t/u.duration):(u.timer.restart(p),u.state=5,1),e=-1,r=c.length;++e<r;)c[e].call(null,n);5===u.state&&(u.on.call("end",o,o.__data__,u.index,u.group),p())}function p(){for(var t in u.state=6,u.timer.stop(),delete f[s],f)return;delete o.__transition}o=t,s=e,u={name:n,index:r,group:i,on:Yn,tween:Bn,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0},((f=o.__transition)[s]=u).timer=On((function(t){u.state=1,u.timer.restart(h,u.delay,u.time),u.delay<=t&&h(t-u.delay)}),0,u.time)}function zn(t,n){if((t=Xn(t,n)).state>0)throw new Error("too late; already scheduled");return t}function jn(t,n){if((t=Xn(t,n)).state>qn)throw new Error("too late; already started");return t}function Xn(t,n){if(t=(t=t.__transition)&&t[n])return t;throw new Error("transition not found")}function Vn(t,n,e){var r=t._id;return t.each((function(){var t=jn(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return Xn(t,r).value[n]}}function Zn(t,n){var e;return("number"==typeof n?an:n instanceof _t?en:(e=_t(n))?(n=e,en):function(t,n){var e,r,i,a,o,s=fn.lastIndex=ln.lastIndex=0,u=-1,c=[],f=[];for(t+="",n+="";(e=fn.exec(t))&&(r=ln.exec(n));)(i=r.index)>s&&(i=n.slice(s,i),c[u]?c[u]+=i:c[++u]=i),(e=e[0])===(r=r[0])?c[u]?c[u]+=r:c[++u]=r:(c[++u]=null,f.push({i:u,x:an(e,r)})),s=ln.lastIndex;return s<n.length&&(i=n.slice(s),c[u]?c[u]+=i:c[++u]=i),c.length<2?f[0]?(o=f[0].x,function(t){return o(t)+""}):(a=n,function(){return a}):(n=f.length,function(t){for(var e,r=0;r<n;++r)c[(e=f[r]).i]=e.x(t);return c.join("")})})(t,n)}var $n=K.prototype.constructor,Wn=0;function Kn(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}at=K.prototype,Kn.prototype={constructor:Kn,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=_(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,u,c=r[o],f=c.length,l=a[o]=new Array(f),h=0;h<f;++h)(s=c[h])&&(u=t.call(s,s.__data__,h,c))&&("__data__"in s&&(u.__data__=s.__data__),l[h]=u,Gn(l[h],n,e,h,l,Xn(s,e)));return new Kn(a,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=y(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var u,c=r[s],f=c.length,l=0;l<f;++l)if(u=c[l]){for(var h,d=t.call(u,u.__data__,l,c),p=Xn(u,e),_=0,g=d.length;_<g;++_)(h=d[_])&&Gn(h,n,e,_,d,p);a.push(d),o.push(u)}return new Kn(a,o,n,e)},filter:function(t){"function"!=typeof t&&(t=b(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o=n[i],s=o.length,u=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&u.push(a);return new Kn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=(t=e.length,Math.min(r,t)),a=new Array(r),o=0;o<i;++o)for(var s,u=n[o],c=e[o],f=u.length,l=a[o]=new Array(f),h=0;h<f;++h)(s=u[h]||c[h])&&(l[h]=s);for(;o<r;++o)a[o]=n[o];return new Kn(a,this._parents,this._name,this._id)},selection:function(){return new $n(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=++Wn,r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,c=0;c<u;++c)(o=s[c])&&Gn(o,t,e,c,s,{time:(o=Xn(o,n)).time+o.delay+o.duration,delay:0,duration:o.duration,ease:o.ease});return new Kn(r,this._parents,t,e)},call:at.call,nodes:at.nodes,node:at.node,size:at.size,empty:at.empty,each:at.each,on:function(t,n){var e,r,i,a,o,s,u=this._id;return arguments.length<2?Xn(this.node(),u).on.on(t):this.each((e=u,i=n,s=((r=t)+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return!(t=0<=n?t.slice(0,n):t)||"start"===t}))?zn:jn,function(){var t=s(this,e),n=t.on;n!==a&&(o=(a=n).copy()).on(r,i),t.on=o}))},attr:function(t,n){var e=h(t),r="transform"===e?yn:Zn;return this.attrTween(t,"function"==typeof n?(e.local?function(t,n,e){var r,i,a;return function(){var o,s=e(this);if(null!=s)return(o=this.getAttributeNS(t.space,t.local))===s?null:o===r&&s===i?a:a=n(r=o,i=s);this.removeAttributeNS(t.space,t.local)}}:function(t,n,e){var r,i,a;return function(){var o,s=e(this);if(null!=s)return(o=this.getAttribute(t))===s?null:o===r&&s===i?a:a=n(r=o,i=s);this.removeAttribute(t)}})(e,r,Vn(this,"attr."+t,n)):null==n?(e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(e):(e.local?function(t,n,e){var r,i;return function(){var a=this.getAttributeNS(t.space,t.local);return a===e?null:a===r?i:i=n(r=a,e)}}:function(t,n,e){var r,i;return function(){var a=this.getAttribute(t);return a===e?null:a===r?i:i=n(r=a,e)}})(e,r,n+""))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;return t=h(t),this.tween(e,(t.local?function(t,n){function e(){var e=this,r=n.apply(e,arguments);return r&&function(n){e.setAttributeNS(t.space,t.local,r(n))}}return e._value=n,e}:function(t,n){function e(){var e=this,r=n.apply(e,arguments);return r&&function(n){e.setAttribute(t,r(n))}}return e._value=n,e})(t,n))},style:function(t,n,e){var r,i,a,o,s,u,c,f,l,h,d,p,_,g,y,v,m,b="transform"==(t+="")?gn:Zn;return null==n?this.styleTween(t,(_=t,g=b,function(){var t=C(this,_),n=(this.style.removeProperty(_),C(this,_));return t===n?null:t===y&&n===v?m:m=g(y=t,v=n)})).on("end.style."+t,(p=t,function(){this.style.removeProperty(p)})):this.styleTween(t,"function"==typeof n?(c=b,f=Vn(this,"style."+(u=t),n),function(){var t=C(this,u),n=f(this);return null==n&&(this.style.removeProperty(u),n=C(this,u)),t===n?null:t===l&&n===h?d:d=c(l=t,h=n)}):(r=t,i=b,a=n+"",function(){var t=C(this,r);return t===a?null:t===o?s:s=i(o=t,a)}),e)},styleTween:function(t,n,e){var r,i,a,o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==n)return this.tween(o,null);if("function"!=typeof n)throw new Error;return this.tween(o,(r=t,i=n,a=null==e?"":e,s._value=i,s));function s(){var t=this,n=i.apply(t,arguments);return n&&function(e){t.style.setProperty(r,n(e),a)}}},text:function(t){return this.tween("text","function"==typeof t?(e=Vn(this,"text",t),function(){var t=e(this);this.textContent=null==t?"":t}):(n=null==t?"":t+"",function(){this.textContent=n}));var n,e},remove:function(){return this.on("end.remove",(t=this._id,function(){var n,e=this.parentNode;for(n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=Xn(this.node(),e).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==n?function(t,n){var e,r;return function(){var i=jn(this,t),a=i.tween;if(a!==e)for(var o=0,s=(r=e=a).length;o<s;++o)if(r[o].name===n){(r=r.slice()).splice(o,1);break}i.tween=r}}:function(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var a=jn(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:n,value:e},u=0,c=i.length;u<c;++u)if(i[u].name===n){i[u]=s;break}u===c&&i.push(s)}a.tween=i}})(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){zn(this,t).delay=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){zn(this,t).delay=n}})(n,t)):Xn(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){jn(this,t).duration=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){jn(this,t).duration=n}})(n,t)):Xn(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(function(t,n){if("function"!=typeof n)throw new Error;return function(){jn(this,t).ease=n}}(n,t)):Xn(this.node(),n).ease}},function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),Math.PI;var Qn=(function t(n){function e(t){return t*t*((n+1)*t-n)}return n=+n,e.overshoot=t,e}(m=1.70158),function t(n){function e(t){return--t*t*((n+1)*t+n)+1}return n=+n,e.overshoot=t,e}(m),function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(m),2*Math.PI),Jn=(function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=Qn);function i(t){return n*Math.pow(2,10*--t)*Math.sin((r-t)/e)}return i.amplitude=function(n){return t(n,e*Qn)},i.period=function(e){return t(n,e)},i}(1,.3),function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=Qn);function i(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/e)}return i.amplitude=function(n){return t(n,e*Qn)},i.period=function(e){return t(n,e)},i}(1,.3),function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=Qn);function i(t){return((t=2*t-1)<0?n*Math.pow(2,10*t)*Math.sin((r-t)/e):2-n*Math.pow(2,-10*t)*Math.sin((r+t)/e))/2}return i.amplitude=function(n){return t(n,e*Qn)},i.period=function(e){return t(n,e)},i}(1,.3),{time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}});function te(t){return{type:t}}K.prototype.interrupt=function(t){return this.each((function(){var n,e,r,i=this,a=t,o=i.__transition,s=!0;if(o){for(r in a=null==a?null:a+"",o)(n=o[r]).name!==a?s=!1:(e=n.state>qn&&n.state<5,n.state=6,n.timer.stop(),e&&n.on.call("interrupt",i,i.__data__,n.index,n.group),delete o[r]);s&&delete i.__transition}}))},K.prototype.transition=function(t){var n,e;t=t instanceof Kn?(n=t._id,t._name):(n=++Wn,(e=Jn).time=Ln(),null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,c=0;c<u;++c)(o=s[c])&&Gn(o,t,n,c,s,e||function(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return Jn.time=Ln(),Jn;return e}(o,n));return new Kn(r,this._parents,t,n)},["e","w"].map(te),["n","s"].map(te),["n","e","s","w","nw","ne","se","sw"].map(te),Math.cos,Math.sin,Math.PI,Math.max,Array.prototype.slice;var ne=Math.PI,ee=2*ne,re=1e-6,ie=ee-re;function ae(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function oe(){return new ae}ae.prototype=oe.prototype={constructor:ae,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,a){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,n,e,r,i){var a,o,s=this._x1,u=this._y1,c=(e=+e)-(t=+t),f=(r=+r)-(n=+n),l=s-t,h=u-n,d=l*l+h*h;if((i=+i)<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+(this._x1=t)+","+(this._y1=n):re<d&&(Math.abs(h*c-f*l)>re&&i?(o=c*c+f*f,r=(e-=s)*e+(s=r-u)*s,u=Math.sqrt(o),a=Math.sqrt(d),d=(o=i*Math.tan((ne-Math.acos((o+d-r)/(2*u*a)))/2))/a,r=o/u,Math.abs(d-1)>re&&(this._+="L"+(t+d*l)+","+(n+d*h)),this._+="A"+i+","+i+",0,0,"+ +(l*s<h*e)+","+(this._x1=t+r*c)+","+(this._y1=n+r*f)):this._+="L"+(this._x1=t)+","+(this._y1=n))},arc:function(t,n,e,r,i,a){t=+t,n=+n;var o=(e=+e)*Math.cos(r),s=e*Math.sin(r),u=t+o,c=n+s,f=1^a;if(a=a?r-i:i-r,e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>re||Math.abs(this._y1-c)>re)&&(this._+="L"+u+","+c),e&&(ie<(a=a<0?a%ee+ee:a)?this._+="A"+e+","+e+",0,1,"+f+","+(t-o)+","+(n-s)+"A"+e+","+e+",0,1,"+f+","+(this._x1=u)+","+(this._y1=c):re<a&&(this._+="A"+e+","+e+",0,"+ +(ne<=a)+","+f+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};const se=oe;var ue="$";function ce(){}function fe(t,n){var e=new ce;if(t instanceof ce)t.each((function(t,n){e.set(n,t)}));else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==n)for(;++i<a;)e.set(i,t[i]);else for(;++i<a;)e.set(n(r=t[i],i,t),r)}else if(t)for(var o in t)e.set(o,t[o]);return e}ce.prototype=fe.prototype={constructor:ce,has:function(t){return ue+t in this},get:function(t){return this[ue+t]},set:function(t,n){return this[ue+t]=n,this},remove:function(t){return(t=ue+t)in this&&delete this[t]},clear:function(){for(var t in this)t[0]===ue&&delete this[t]},keys:function(){var t,n=[];for(t in this)t[0]===ue&&n.push(t.slice(1));return n},values:function(){var t,n=[];for(t in this)t[0]===ue&&n.push(this[t]);return n},entries:function(){var t,n=[];for(t in this)t[0]===ue&&n.push({key:t.slice(1),value:this[t]});return n},size:function(){var t,n=0;for(t in this)t[0]===ue&&++n;return n},empty:function(){for(var t in this)if(t[0]===ue)return!1;return!0},each:function(t){for(var n in this)n[0]===ue&&t(this[n],n.slice(1),this)}};const le=fe;function he(){}function de(t,n){var e=new he;if(t instanceof he)t.each((function(t){e.add(t)}));else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}at=le.prototype,he.prototype=de.prototype={constructor:he,has:at.has,add:function(t){return this[ue+(t+="")]=t,this},remove:at.remove,clear:at.clear,values:at.keys,size:at.size,empty:at.empty,each:at.each};const pe=de;var _e={},ge={};function ye(t){return new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+"]"})).join(",")+"}")}function ve(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],a=t.length,o=0,s=0,u=a<=0,c=!1;function f(){if(u)return ge;if(c)return c=!1,_e;var n,r,i=o;if(34===t.charCodeAt(i)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(n=o)>=a?u=!0:10===(r=t.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(o))&&++o,t.slice(i+1,n-1).replace(/""/g,'"')}for(;o<a;){if(10===(r=t.charCodeAt(n=o++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(o)&&++o;else if(r!==e)continue;return t.slice(i,n)}return u=!0,t.slice(i,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(r=f())!==ge;){for(var l=[];r!==_e&&r!==ge;)l.push(r),r=f();n&&null==(l=n(l,s++))||i.push(l)}return i}function i(n){return n.map(a).join(t)}function a(t){return null==t?"":n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i;return(t=r(t,(function(t,r){if(e)return e(t,r-1);var a,o,s;i=t,e=n?(o=n,s=ye(a=t),function(t,n){return o(s(t),n,a)}):ye(t)}))).columns=i||[],t},parseRows:r,format:function(n,e){var r,i,o;return null==e&&(r=n,i=Object.create(null),o=[],r.forEach((function(t){for(var n in t)n in i||o.push(i[n]=n)})),e=o),[e.map(a).join(t)].concat(n.map((function(n){return e.map((function(t){return a(n[t])})).join(t)}))).join("\n")},formatRows:function(t){return t.map(i).join("\n")}}}at=(m=ve(",")).parse;var me,be=(m.parseRows,m.format,m.formatRows,m=ve("\t")).parse;function xe(t,n,e,r){if(!isNaN(n)&&!isNaN(e)){var i,a,o,s,u,c,f,l,h,d=t._root,p={data:r},_=t._x0,g=t._y0,y=t._x1,v=t._y1;if(d){for(;d.length;)if((c=n>=(a=(_+y)/2))?_=a:y=a,(f=e>=(o=(g+v)/2))?g=o:v=o,!(d=(i=d)[l=f<<1|c]))return i[l]=p,t;if(s=+t._x.call(null,d.data),u=+t._y.call(null,d.data),n===s&&e===u)p.next=d,i?i[l]=p:t._root=p;else{for(;i=i?i[l]=new Array(4):t._root=new Array(4),(c=n>=(a=(_+y)/2))?_=a:y=a,(f=e>=(o=(g+v)/2))?g=o:v=o,(l=f<<1|c)==(h=(o<=u)<<1|a<=s););i[h]=d,i[l]=p}}else t._root=p}return t}function we(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Me(t,n,e,r,i,a){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Te(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}function Ae(t,n){var e;return(n=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0?null:[1<(e=t.slice(0,n)).length?e[0]+e.slice(2):e,+t.slice(n+1)]}function Ee(t,n){var e;return(n=Ae(t,n))?(e=n[0],(n=n[1])<0?"0."+new Array(-n).join("0")+e:e.length>n+1?e.slice(0,n+1)+"."+e.slice(n+1):e+new Array(n-e.length+2).join("0")):t+""}m.parseRows,m.format,m.formatRows,(m=Me.prototype).copy=function(){var t,n,e=new Me(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(r)if(r.length)for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Te(n));else e._root=Te(r);return e},m.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return xe(this.cover(n,e),n,e,t)},m.addAll=function(t){for(var n,e,r=t.length,i=new Array(r),a=new Array(r),o=1/0,s=1/0,u=-1/0,c=-1/0,f=0;f<r;++f)isNaN(n=+this._x.call(null,e=t[f]))||isNaN(e=+this._y.call(null,e))||((i[f]=n)<o&&(o=n),u<n&&(u=n),(a[f]=e)<s&&(s=e),c<e&&(c=e));for(u<o&&(o=this._x0,u=this._x1),c<s&&(s=this._y0,c=this._y1),this.cover(o,s).cover(u,c),f=0;f<r;++f)xe(this,i[f],a[f],t[f]);return this},m.cover=function(t,n){if(!isNaN(t=+t)&&!isNaN(n=+n)){var e=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,a=(r=Math.floor(n))+1;else{if(!(t<e||i<t||n<r||a<n))return this;var o,s,u=i-e,c=this._root;switch(s=(n<(r+a)/2)<<1|t<(e+i)/2){case 0:for(;(o=new Array(4))[s]=c,c=o,a=r+(u*=2),(i=e+u)<t||a<n;);break;case 1:for(;(o=new Array(4))[s]=c,c=o,a=r+(u*=2),t<(e=i-u)||a<n;);break;case 2:for(;(o=new Array(4))[s]=c,c=o,r=a-(u*=2),(i=e+u)<t||n<r;);break;case 3:for(;(o=new Array(4))[s]=c,c=o,r=a-(u*=2),t<(e=i-u)||n<r;);}this._root&&this._root.length&&(this._root=c)}this._x0=e,this._y0=r,this._x1=i,this._y1=a}return this},m.data=function(){var t=[];return this.visit((function(n){if(!n.length)for(;t.push(n.data),n=n.next;);})),t},m.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},m.find=function(t,n,e){var r,i,a,o,s,u,c,f,l=this._x0,h=this._y0,d=this._x1,p=this._y1,_=[],g=this._root;for(g&&_.push(new we(g,l,h,d,p)),null==e?e=1/0:(l=t-e,h=n-e,d=t+e,p=n+e,e*=e);r=_.pop();)!(g=r.node)||(s=r.x0)>d||(u=r.y0)>p||(o=r.x1)<l||(i=r.y1)<h||(g.length?(_.push(new we(g[3],a=(s+o)/2,c=(u+i)/2,o,i),new we(g[2],s,c,a,i),new we(g[1],a,u,o,c),new we(g[0],s,u,a,c)),(i=(c<=n)<<1|a<=t)&&(r=_[_.length-1],_[_.length-1]=_[_.length-1-i],_[_.length-1-i]=r)):(u=(o=t-+this._x.call(null,g.data))*o+(s=n-+this._y.call(null,g.data))*s)<e&&(l=t-(c=Math.sqrt(e=u)),h=n-c,d=t+c,p=n+c,f=g.data));return f},m.remove=function(t){if(!isNaN(a=+this._x.call(null,t))&&!isNaN(o=+this._y.call(null,t))){var n,e,r,i,a,o,s,u,c,f,l,h=this._root,d=this._x0,p=this._y0,_=this._x1,g=this._y1;if(h){if(h.length)for(;;){if((u=a>=(s=(d+_)/2))?d=s:_=s,(c=o>=(s=(p+g)/2))?p=s:g=s,!(h=(n=h)[f=c<<1|u]))return this;if(!h.length)break;(n[f+1&3]||n[f+2&3]||n[f+3&3])&&(e=n,l=f)}for(;h.data!==t;)if(!(h=(r=h).next))return this;(i=h.next)&&delete h.next,r?i?r.next=i:delete r.next:n?(i?n[f]=i:delete n[f],(h=n[0]||n[1]||n[2]||n[3])&&h===(n[3]||n[2]||n[1]||n[0])&&!h.length&&(e?e[l]=h:this._root=h)):this._root=i}}return this},m.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},m.root=function(){return this._root},m.size=function(){var t=0;return this.visit((function(n){if(!n.length)for(;++t,n=n.next;);})),t},m.visit=function(t){var n,e,r,i,a,o,s,u=[],c=this._root;for(c&&u.push(new we(c,this._x0,this._y0,this._x1,this._y1));a=u.pop();)!t(c=a.node,e=a.x0,r=a.y0,i=a.x1,a=a.y1)&&c.length&&(o=(e+i)/2,s=(r+a)/2,(n=c[3])&&u.push(new we(n,o,s,i,a)),(n=c[2])&&u.push(new we(n,e,s,o,a)),(n=c[1])&&u.push(new we(n,o,r,i,s)),n=c[0])&&u.push(new we(n,e,r,o,s));return this},m.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new we(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i,a,o,s,u,c,f,l=n.node;l.length&&(a=n.x0,o=n.y0,c=(a+(s=n.x1))/2,f=(o+(u=n.y1))/2,(i=l[0])&&e.push(new we(i,a,o,c,f)),(i=l[1])&&e.push(new we(i,c,o,s,f)),(i=l[2])&&e.push(new we(i,a,f,c,u)),i=l[3])&&e.push(new we(i,c,f,s,u)),r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},m.x=function(t){return arguments.length?(this._x=t,this):this._x},m.y=function(t){return arguments.length?(this._y=t,this):this._y},Math.PI,Math.sqrt(5);const Ce={"":function(t,n){t:for(var e,r=(t=t.toPrecision(n)).length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=e=i;break;case"0":0===a&&(a=i),e=i;break;case"e":break t;default:0<a&&(a=0)}return 0<a?t.slice(0,a)+t.slice(e+1):t},"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return Ee(100*t,n)},r:Ee,s:function(t,n){var e,r,i=Ae(t,n);return i?(e=i[0],(i=(i=i[1])-(me=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1)===(r=e.length)?e:r<i?e+new Array(i-r+1).join("0"):0<i?e.slice(0,i)+"."+e.slice(i):"0."+new Array(1-i).join("0")+Ae(t,Math.max(0,n+i-1))[0]):t+""},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};var Se=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function ke(t){return new Ne(t)}function Ne(t){if(!(u=Se.exec(t)))throw new Error("invalid format: "+t);t=u[1]||" ";var n=u[2]||">",e=u[3]||"-",r=u[4]||"",i=!!u[5],a=u[6]&&+u[6],o=!!u[7],s=u[8]&&+u[8].slice(1),u=u[9]||"";"n"===u?(o=!0,u="g"):Ce[u]||(u=""),(i||"0"===t&&"="===n)&&(i=!0,t="0",n="="),this.fill=t,this.align=n,this.sign=e,this.symbol=r,this.zero=i,this.width=a,this.comma=o,this.precision=s,this.type=u}function De(t){return t}ke.prototype=Ne.prototype,Ne.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Le=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Pe(){return new Ue}function Ue(){this.reset()}m=function(t){var n,e,r,i=t.grouping&&t.thousands?(e=t.grouping,r=t.thousands,function(t,n){for(var i=t.length,a=[],o=0,s=e[0],u=0;0<i&&0<s&&(n<u+s+1&&(s=Math.max(1,n-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(r)}):De,a=t.currency,o=t.decimal,s=t.numerals?(n=t.numerals,function(t){return t.replace(/[0-9]/g,(function(t){return n[+t]}))}):De,u=t.percent||"%";function c(t){var n=(t=ke(t)).fill,e=t.align,r=t.sign,c=t.symbol,f=t.zero,l=t.width,h=t.comma,d=t.precision,p=t.type,_="$"===c?a[0]:"#"===c&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",g="$"===c?a[1]:/[%p]/.test(p)?u:"",y=Ce[p],v=!p||/[defgprs%]/.test(p);function m(t){var a,u,c,m=_,b=g;if("c"===p)b=y(t)+b,t="";else{var x=(t=+t)<0;if(t=y(Math.abs(t),d),m=((x=(!x||0!=+t)&&x)?"("===r?r:"-":"-"===r||"("===r?"":r)+m,b=("s"===p?Le[8+me/3]:"")+b+(x&&"("===r?")":""),v)for(a=-1,u=t.length;++a<u;)if((c=t.charCodeAt(a))<48||57<c){b=(46===c?o+t.slice(a+1):t.slice(a))+b,t=t.slice(0,a);break}}h&&!f&&(t=i(t,1/0));var w=m.length+t.length+b.length,M=w<l?new Array(l-w+1).join(n):"";switch(h&&f&&(t=i(M+t,M.length?l-b.length:1/0),M=""),e){case"<":t=m+t+b+M;break;case"=":t=m+M+t+b;break;case"^":t=M.slice(0,w=M.length>>1)+m+t+b+M.slice(w);break;default:t=M+m+t+b}return s(t)}return d=null==d?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),m.toString=function(){return t+""},m}return{format:c,formatPrefix:function(t,n){var e=c(((t=ke(t)).type="f",t)),r=(n=3*Math.max(-8,Math.min(8,Math.floor((t=n,((t=Ae(Math.abs(t)))?t[1]:NaN)/3)))),Math.pow(10,-n)),i=Le[8+n/3];return function(t){return e(r*t)+i}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),m.format,m.formatPrefix,Ue.prototype={constructor:Ue,reset:function(){this.s=this.t=0},add:function(t){He(Oe,t,this.t),He(this,Oe.s,this.s),this.s?this.t+=Oe.t:this.s=Oe.t},valueOf:function(){return this.s}};var Oe=new Ue;function He(t,n,e){var r=t.s=n+e,i=r-n;t.t=n-(r-i)+(e-i)}var Re=Math.PI,Fe=Re/2,Ie=Re/180,Ye=(Math.abs,Math.atan),Be=Math.atan2,qe=Math.cos,Ge=(Math.ceil,Math.exp,Math.floor,Math.log,Math.pow,Math.sin),ze=(Math.sign,Math.sqrt);function je(t){return 1<t?Fe:t<-1?-Fe:Math.asin(t)}function Xe(){}function Ve(t){return function(n,e){var r=qe(n),i=qe(e);return[(r=t(r*i))*i*Ge(n),r*Ge(e)]}}function Ze(t){return function(n,e){var r=ze(n*n+e*e),i=t(r),a=Ge(i);return i=qe(i),[Be(n*a,r*i),je(r&&e*a/r)]}}function $e(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;0<=--r;)n+=e[r].value;else n=1;t.value=n}function We(t,n){var e,r,i,a,o,s=new tr(t),u=+t.value&&(s.value=t.value),c=[s];for(null==n&&(n=Ke);e=c.pop();)if(u&&(e.value=+e.data.value),(i=n(e.data))&&(o=i.length))for(e.children=new Array(o),a=o-1;0<=a;--a)c.push(r=e.children[a]=new tr(i[a])),r.parent=e,r.depth=e.depth+1;return s.eachBefore(Je)}function Ke(t){return t.children}function Qe(t){t.data=t.data.data}function Je(t){for(var n=0;t.height=n,(t=t.parent)&&t.height<++n;);}function tr(t){this.data=t,this.depth=this.height=0,this.parent=null}function nr(t,n,e,r,i){for(var a,o=t.children,s=-1,u=o.length,c=t.value&&(r-n)/t.value;++s<u;)(a=o[s]).y0=e,a.y1=i,a.x0=n,a.x1=n+=a.value*c}function er(t,n,e,r,i){for(var a,o=t.children,s=-1,u=o.length,c=t.value&&(i-e)/t.value;++s<u;)(a=o[s]).x0=n,a.x1=r,a.y0=e,a.y1=e+=a.value*c}function rr(t,n,e,r,i,a){for(var o,s,u,c,f,l,h,d,p,_,g,y=[],v=n.children,m=0,b=0,x=v.length,w=n.value;m<x;){for(u=i-e,c=a-r;!(f=v[b++].value)&&b<x;);for(g=(l=h=f)*f*(_=Math.max(c/u,u/c)/(w*t)),p=Math.max(h/g,g/l);b<x;++b){if(f+=s=v[b].value,s<l&&(l=s),h<s&&(h=s),g=f*f*_,p<(d=Math.max(h/g,g/l))){f-=s;break}p=d}y.push(o={value:f,dice:u<c,children:v.slice(m,b)}),o.dice?nr(o,e,r,i,w?r+=c*f/w:a):er(o,e,r,w?e+=u*f/w:i,a),w-=f,m=b}return y}function ir(){return Math.random()}Math.tan,Pe(),Pe(),Pe(),Pe(),Pe(),Pe(),Pe(),Pe(),Xe.prototype={constructor:Xe,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},qe(30*Ie),(m=Ve((function(t){return ze(2/(1+t))}))).invert=Ze((function(t){return 2*je(t/2)})),m=Ve((function(t){return(t=1<(n=t)?0:n<-1?Re:Math.acos(n))&&t/Ge(t);var n})),m.invert=Ze((function(t){return t})),Ze(Ye),Ze(je),Ze((function(t){return 2*Ye(t)})),tr.prototype=We.prototype={constructor:tr,count:function(){return this.eachAfter($e)},each:function(t){var n,e,r,i,a,o=[this];do{for(e=o.reverse(),o=[];n=e.pop();)if(t(n),r=n.children)for(i=0,a=r.length;i<a;++i)o.push(r[i])}while(o.length);return this},eachAfter:function(t){for(var n,e,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),n=i.children)for(e=0,r=n.length;e<r;++e)a.push(n[e]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var n,e,r,i=[this];n=i.pop();)if(t(n),e=n.children)for(r=e.length-1;0<=r;--r)i.push(e[r]);return this},sum:function(t){return this.eachAfter((function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;0<=--i;)e+=r[i].value;n.value=e}))},sort:function(t){return this.eachBefore((function(n){n.children&&n.children.sort(t)}))},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;for(t=e.pop(),n=r.pop();t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){var t=[];return this.each((function(n){t.push(n)})),t},leaves:function(){var t=[];return this.eachBefore((function(n){n.children||t.push(n)})),t},links:function(){var t=this,n=[];return t.each((function(e){e!==t&&n.push({source:e.parent,target:e})})),n},copy:function(){return We(this).eachBefore(Qe)}},Array.prototype.slice,Object.create(tr.prototype),function t(n){function e(t,e,r,i,a){rr(n,t,e,r,i,a)}return e.ratio=function(n){return t(1<(n=+n)?n:1)},e}(m=(1+Math.sqrt(5))/2),function t(n){function e(t,e,r,i,a){if((o=t._squarify)&&o.ratio===n)for(var o,s,u,c,f,l=-1,h=o.length,d=t.value;++l<h;){for(u=(s=o[l]).children,c=s.value=0,f=u.length;c<f;++c)s.value+=u[c].value;s.dice?nr(s,e,r,i,r+=(a-r)*s.value/d):er(s,e,r,e+=(i-e)*s.value/d,a),d-=s.value}else t._squarify=o=rr(n,t,e,r,i,a),o.ratio=n}return e.ratio=function(n){return t(1<(n=+n)?n:1)},e}(m),function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(ir);const ar=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var a;if(null!=r)a=r,r=null;else for(;r=2*n()-1,a=2*n()-1,!(i=r*r+a*a)||1<i;);return t+e*a*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}(ir);!function t(n){function e(){var t=ar.source(n).apply(this,arguments);return function(){return Math.exp(t())}}return e.source=t,e}(ir);const or=function t(n){function e(t){return function(){for(var e=0,r=0;r<t;++r)e+=n();return e}}return e.source=t,e}(ir);function sr(t,n){var e,r,i,a,o=c("beforesend","progress","load","error"),s=le(),u=new XMLHttpRequest,f=null,l=null,h=0;function d(t){var n,r,a,s=u.status;if(!s&&((a=(r=u).responseType)&&"text"!==a?r.response:r.responseText)||200<=s&&s<300||304===s){if(i)try{n=i.call(e,u)}catch(t){return void o.call("error",e,t)}else n=u;o.call("load",e,n)}else o.call("error",e,t)}if("onload"in(u="undefined"==typeof XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)?u:new XDomainRequest)?u.onload=u.onerror=u.ontimeout=d:u.onreadystatechange=function(t){3<u.readyState&&d(t)},u.onprogress=function(t){o.call("progress",e,t)},e={header:function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?s.get(t):(null==n?s.remove(t):s.set(t,n+""),e)},mimeType:function(t){return arguments.length?(r=null==t?null:t+"",e):r},responseType:function(t){return arguments.length?(a=t,e):a},timeout:function(t){return arguments.length?(h=+t,e):h},user:function(t){return arguments.length<1?f:(f=null==t?null:t+"",e)},password:function(t){return arguments.length<1?l:(l=null==t?null:t+"",e)},response:function(t){return i=t,e},get:function(t,n){return e.send("GET",t,n)},post:function(t,n){return e.send("POST",t,n)},send:function(n,i,c){var d;return u.open(n,t,!0,f,l),null==r||s.has("accept")||s.set("accept",r+",*/*"),u.setRequestHeader&&s.each((function(t,n){u.setRequestHeader(n,t)})),null!=r&&u.overrideMimeType&&u.overrideMimeType(r),null!=a&&(u.responseType=a),0<h&&(u.timeout=h),null==c&&"function"==typeof i&&(c=i,i=null),null!=c&&1===c.length&&(d=c,c=function(t,n){d(null==t?n:null)}),null!=c&&e.on("error",c).on("load",(function(t){c(null,t)})),o.call("beforesend",e,u),u.send(null==i?null:i),e},abort:function(){return u.abort(),e},on:function(){var t=o.on.apply(o,arguments);return t===o?e:t}},null==n)return e;if("function"!=typeof n)throw new Error("invalid callback: "+n);return e.get(n)}function ur(t,n){return function(e,r){if(e=sr(e).mimeType(t).response(n),null==r)return e;if("function"!=typeof r)throw new Error("invalid callback: "+r);return e.get(r)}}function cr(t,n){return function(e,r,i){arguments.length<3&&(i=r,r=null);var a=sr(e).mimeType(t);return a.row=function(t){return arguments.length?a.response((e=n,i=r=t,function(t){return e(t.responseText,i)})):r;var e,i},a.row(r),i?a.get(i):a}}(function t(n){function e(t){var e=or.source(n)(t);return function(){return e()/t}}return e.source=t,e})(ir),function t(n){function e(t){return function(){return-Math.log(1-n())/t}}return e.source=t,e}(ir),ur("text/html",(function(t){return document.createRange().createContextualFragment(t.responseText)})),ur("application/json",(function(t){return JSON.parse(t.responseText)})),ur("text/plain",(function(t){return t.responseText})),ur("application/xml",(function(t){if(t=t.responseXML)return t;throw new Error("parse error")})),cr("text/csv",at),cr("text/tab-separated-values",be),(m=Array.prototype).map,m.slice;var fr=new Date,lr=new Date;function hr(t,n,e,r){function i(n){return t(n=new Date(+n)),n}return(i.floor=i).ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,a){var o,s=[];if(e=i.ceil(e),a=null==a?1:Math.floor(a),e<r&&0<a)for(;s.push(o=new Date(+e)),n(e,a),t(e),o<e&&e<r;);return s},i.filter=function(e){return hr((function(n){if(n<=n)for(;t(n),!e(n);)n.setTime(n-1)}),(function(t,r){if(t<=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;0<=--r;)for(;n(t,1),!e(t););}))},e&&(i.count=function(n,r){return fr.setTime(+n),lr.setTime(+r),t(fr),t(lr),Math.floor(e(fr,lr))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&0<t?1<t?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var dr=hr((function(){}),(function(t,n){t.setTime(+t+n)}),(function(t,n){return n-t})),pr=(dr.every=function(t){return t=Math.floor(t),isFinite(t)&&0<t?1<t?hr((function(n){n.setTime(Math.floor(n/t)*t)}),(function(n,e){n.setTime(+n+e*t)}),(function(n,e){return(e-n)/t})):dr:null},dr.range,6e4),_r=36e5;at=hr((function(t){t.setTime(1e3*Math.floor(t/1e3))}),(function(t,n){t.setTime(+t+1e3*n)}),(function(t,n){return(n-t)/1e3}),(function(t){return t.getUTCSeconds()})),at.range,be=hr((function(t){t.setTime(Math.floor(t/pr)*pr)}),(function(t,n){t.setTime(+t+n*pr)}),(function(t,n){return(n-t)/pr}),(function(t){return t.getMinutes()})),be.range,m=hr((function(t){var n=t.getTimezoneOffset()*pr%_r;n<0&&(n+=_r),t.setTime(Math.floor((+t-n)/_r)*_r+n)}),(function(t,n){t.setTime(+t+n*_r)}),(function(t,n){return(n-t)/_r}),(function(t){return t.getHours()})),m.range,at=hr((function(t){t.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*pr)/864e5}),(function(t){return t.getDate()-1}));const gr=at;function yr(t){return hr((function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+7*n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*pr)/6048e5}))}at.range;var vr=yr(0),mr=yr(1),br=(be=yr(2),m=yr(3),yr(4)),xr=(at=yr(5),yr(6));vr.range,mr.range,be.range,m.range,br.range,at.range,xr.range,be=hr((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),be.range,m=hr((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t,n){return n.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()})),m.every=function(t){return isFinite(t=Math.floor(t))&&0<t?hr((function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)}),(function(n,e){n.setFullYear(n.getFullYear()+e*t)})):null};const wr=m;m.range,at=hr((function(t){t.setUTCSeconds(0,0)}),(function(t,n){t.setTime(+t+n*pr)}),(function(t,n){return(n-t)/pr}),(function(t){return t.getUTCMinutes()})),at.range,xr=hr((function(t){t.setUTCMinutes(0,0,0)}),(function(t,n){t.setTime(+t+n*_r)}),(function(t,n){return(n-t)/_r}),(function(t){return t.getUTCHours()})),xr.range,be=hr((function(t){t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+n)}),(function(t,n){return(n-t)/864e5}),(function(t){return t.getUTCDate()-1}));const Mr=be;function Tr(t){return hr((function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+7*n)}),(function(t,n){return(n-t)/6048e5}))}be.range;var Ar=Tr(0),Er=Tr(1),Cr=(m=Tr(2),at=Tr(3),Tr(4));xr=Tr(5),be=Tr(6),Ar.range,Er.range,m.range,at.range,Cr.range,xr.range,be.range,m=hr((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCMonth(t.getUTCMonth()+n)}),(function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),m.range,at=hr((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)}),(function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})),at.every=function(t){return isFinite(t=Math.floor(t))&&0<t?hr((function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)}),(function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)})):null};const Sr=at;function kr(t){var n;return 0<=t.y&&t.y<100?((n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L)).setFullYear(t.y),n):new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Nr(t){var n;return 0<=t.y&&t.y<100?((n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L))).setUTCFullYear(t.y),n):new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Dr(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}at.range;var Lr={"-":"",_:" ",0:"0"},Pr=/^\s*\d+/,Ur=/^%/,Or=/[\\^$*+?|[\]().{}]/g;function Hr(t,n,e){var r=t<0?"-":"",i=(t=(r?-t:t)+"").length;return r+(i<e?new Array(e-i+1).join(n)+t:t)}function Rr(t){return t.replace(Or,"\\$&")}function Fr(t){return new RegExp("^(?:"+t.map(Rr).join("|")+")","i")}function Ir(t){for(var n={},e=-1,r=t.length;++e<r;)n[t[e].toLowerCase()]=e;return n}function Yr(t,n,e){return(n=Pr.exec(n.slice(e,e+1)))?(t.w=+n[0],e+n[0].length):-1}function Br(t,n,e){return(n=Pr.exec(n.slice(e,e+1)))?(t.u=+n[0],e+n[0].length):-1}function qr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.U=+n[0],e+n[0].length):-1}function Gr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.V=+n[0],e+n[0].length):-1}function zr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.W=+n[0],e+n[0].length):-1}function jr(t,n,e){return(n=Pr.exec(n.slice(e,e+4)))?(t.y=+n[0],e+n[0].length):-1}function Xr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.y=+n[0]+(68<+n[0]?1900:2e3),e+n[0].length):-1}function Vr(t,n,e){return(n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6)))?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),e+n[0].length):-1}function Zr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.m=n[0]-1,e+n[0].length):-1}function $r(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.d=+n[0],e+n[0].length):-1}function Wr(t,n,e){return(n=Pr.exec(n.slice(e,e+3)))?(t.m=0,t.d=+n[0],e+n[0].length):-1}function Kr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.H=+n[0],e+n[0].length):-1}function Qr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.M=+n[0],e+n[0].length):-1}function Jr(t,n,e){return(n=Pr.exec(n.slice(e,e+2)))?(t.S=+n[0],e+n[0].length):-1}function ti(t,n,e){return(n=Pr.exec(n.slice(e,e+3)))?(t.L=+n[0],e+n[0].length):-1}function ni(t,n,e){return(n=Pr.exec(n.slice(e,e+6)))?(t.L=Math.floor(n[0]/1e3),e+n[0].length):-1}function ei(t,n,e){return(n=Ur.exec(n.slice(e,e+1)))?e+n[0].length:-1}function ri(t,n,e){return(n=Pr.exec(n.slice(e)))?(t.Q=+n[0],e+n[0].length):-1}function ii(t,n,e){return(n=Pr.exec(n.slice(e)))?(t.Q=1e3*+n[0],e+n[0].length):-1}function ai(t,n){return Hr(t.getDate(),n,2)}function oi(t,n){return Hr(t.getHours(),n,2)}function si(t,n){return Hr(t.getHours()%12||12,n,2)}function ui(t,n){return Hr(1+gr.count(wr(t),t),n,3)}function ci(t,n){return Hr(t.getMilliseconds(),n,3)}function fi(t,n){return ci(t,n)+"000"}function li(t,n){return Hr(t.getMonth()+1,n,2)}function hi(t,n){return Hr(t.getMinutes(),n,2)}function di(t,n){return Hr(t.getSeconds(),n,2)}function pi(t){return 0===(t=t.getDay())?7:t}function _i(t,n){return Hr(vr.count(wr(t),t),n,2)}function gi(t,n){var e=t.getDay();return t=4<=e||0===e?br(t):br.ceil(t),Hr(br.count(wr(t),t)+(4===wr(t).getDay()),n,2)}function yi(t){return t.getDay()}function vi(t,n){return Hr(mr.count(wr(t),t),n,2)}function mi(t,n){return Hr(t.getFullYear()%100,n,2)}function bi(t,n){return Hr(t.getFullYear()%1e4,n,4)}function xi(t){return(0<(t=t.getTimezoneOffset())?"-":(t*=-1,"+"))+Hr(t/60|0,"0",2)+Hr(t%60,"0",2)}function wi(t,n){return Hr(t.getUTCDate(),n,2)}function Mi(t,n){return Hr(t.getUTCHours(),n,2)}function Ti(t,n){return Hr(t.getUTCHours()%12||12,n,2)}function Ai(t,n){return Hr(1+Mr.count(Sr(t),t),n,3)}function Ei(t,n){return Hr(t.getUTCMilliseconds(),n,3)}function Ci(t,n){return Ei(t,n)+"000"}function Si(t,n){return Hr(t.getUTCMonth()+1,n,2)}function ki(t,n){return Hr(t.getUTCMinutes(),n,2)}function Ni(t,n){return Hr(t.getUTCSeconds(),n,2)}function Di(t){return 0===(t=t.getUTCDay())?7:t}function Li(t,n){return Hr(Ar.count(Sr(t),t),n,2)}function Pi(t,n){var e=t.getUTCDay();return t=4<=e||0===e?Cr(t):Cr.ceil(t),Hr(Cr.count(Sr(t),t)+(4===Sr(t).getUTCDay()),n,2)}function Ui(t){return t.getUTCDay()}function Oi(t,n){return Hr(Er.count(Sr(t),t),n,2)}function Hi(t,n){return Hr(t.getUTCFullYear()%100,n,2)}function Ri(t,n){return Hr(t.getUTCFullYear()%1e4,n,4)}function Fi(){return"+0000"}function Ii(){return"%"}function Yi(t){return+t}function Bi(t){return Math.floor(+t/1e3)}function qi(t){return t.match(/.{6}/g).map((function(t){return"#"+t}))}function Gi(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}(xr=function(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,u=t.shortMonths,c=Fr(i),f=Ir(i),l=Fr(a),h=Ir(a),d=Fr(o),p=Ir(o),_=Fr(s),g=Ir(s),y=Fr(u),v=Ir(u),m={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:ai,e:ai,f:fi,H:oi,I:si,j:ui,L:ci,m:li,M:hi,p:function(t){return i[+(12<=t.getHours())]},Q:Yi,s:Bi,S:di,u:pi,U:_i,V:gi,w:yi,W:vi,x:null,X:null,y:mi,Y:bi,Z:xi,"%":Ii},b={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:wi,e:wi,f:Ci,H:Mi,I:Ti,j:Ai,L:Ei,m:Si,M:ki,p:function(t){return i[+(12<=t.getUTCHours())]},Q:Yi,s:Bi,S:Ni,u:Di,U:Li,V:Pi,w:Ui,W:Oi,x:null,X:null,y:Hi,Y:Ri,Z:Fi,"%":Ii},x={a:function(t,n,e){return(n=d.exec(n.slice(e)))?(t.w=p[n[0].toLowerCase()],e+n[0].length):-1},A:function(t,n,e){return(n=l.exec(n.slice(e)))?(t.w=h[n[0].toLowerCase()],e+n[0].length):-1},b:function(t,n,e){return(n=y.exec(n.slice(e)))?(t.m=v[n[0].toLowerCase()],e+n[0].length):-1},B:function(t,n,e){return(n=_.exec(n.slice(e)))?(t.m=g[n[0].toLowerCase()],e+n[0].length):-1},c:function(t,e,r){return T(t,n,e,r)},d:$r,e:$r,f:ni,H:Kr,I:Kr,j:Wr,L:ti,m:Zr,M:Qr,p:function(t,n,e){return(n=c.exec(n.slice(e)))?(t.p=f[n[0].toLowerCase()],e+n[0].length):-1},Q:ri,s:ii,S:Jr,u:Br,U:qr,V:Gr,w:Yr,W:zr,x:function(t,n,r){return T(t,e,n,r)},X:function(t,n,e){return T(t,r,n,e)},y:Xr,Y:jr,Z:Vr,"%":ei};function w(t,n){return function(e){var r,i,a,o=[],s=-1,u=0,c=t.length;for(e instanceof Date||(e=new Date(+e));++s<c;)37===t.charCodeAt(s)&&(o.push(t.slice(u,s)),null!=(i=Lr[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=n[r])&&(r=a(e,i)),o.push(r),u=s+1);return o.push(t.slice(u,s)),o.join("")}}function M(t,n){return function(e){var r,i,a=Dr(1900);if(T(a,t,e+="",0)!=e.length)return null;if("Q"in a)return new Date(a.Q);if("p"in a&&(a.H=a.H%12+12*a.p),"V"in a){if(a.V<1||53<a.V)return null;"w"in a||(a.w=1),"Z"in a?(r=4<(i=(r=Nr(Dr(a.y))).getUTCDay())||0===i?Er.ceil(r):Er(r),r=Mr.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(r=4<(i=(r=n(Dr(a.y))).getDay())||0===i?mr.ceil(r):mr(r),r=gr.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?Nr(Dr(a.y)).getUTCDay():n(Dr(a.y)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return("Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Nr):n)(a)}}function T(t,n,e,r){for(var i,a,o=0,s=n.length,u=e.length;o<s;){if(u<=r)return-1;if(37===(i=n.charCodeAt(o++))){if(i=n.charAt(o++),!(a=x[i in Lr?n.charAt(o++):i])||(r=a(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return m.x=w(e,m),m.X=w(r,m),m.c=w(n,m),b.x=w(e,b),b.X=w(r,b),b.c=w(n,b),{format:function(t){var n=w(t+="",m);return n.toString=function(){return t},n},parse:function(t){var n=M(t+="",kr);return n.toString=function(){return t},n},utcFormat:function(t){var n=w(t+="",b);return n.toString=function(){return t},n},utcParse:function(t){var n=M(t,Nr);return n.toString=function(){return t},n}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})).format,xr.parse,be=xr.utcFormat,m=xr.utcParse,at="%Y-%m-%dT%H:%M:%S.%LZ",Date.prototype.toISOString||be(at),+new Date("2000-01-01T00:00:00.000Z")||m(at),qi("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),qi("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),qi("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),qi("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),it($t(300,.5,0),$t(-240,.5,1)),it($t(-100,.75,.35),$t(80,1.5,.8)),it($t(260,.75,.35),$t(80,1.5,.8)),$t(),Gi(qi("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Gi(qi("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Gi(qi("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Gi(qi("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,be=2*(xr=Math.PI);var zi,ji,Xi,Vi=Array.prototype.slice;function Zi(t){return function(){return t}}function $i(t){return t[0]}function Wi(t){return t[1]}function Ki(t){return t.source}function Qi(t){return t.target}function Ji(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function ta(){}function na(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function ea(t){this._context=t}function ra(t,n){this._basis=new ea(t),this._beta=n}function ia(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function aa(t,n){this._context=t,this._k=(1-n)/6}function oa(t,n){this._context=t,this._k=(1-n)/6}function sa(t,n){this._context=t,this._k=(1-n)/6}function ua(t,n,e){var r,i,a=t._x1,o=t._y1,s=t._x2,u=t._y2;1e-12<t._l01_a&&(r=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,i=3*t._l01_a*(t._l01_a+t._l12_a),a=(a*r-t._x0*t._l12_2a+t._x2*t._l01_2a)/i,o=(o*r-t._y0*t._l12_2a+t._y2*t._l01_2a)/i),1e-12<t._l23_a&&(r=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,i=3*t._l23_a*(t._l23_a+t._l12_a),s=(s*r+t._x1*t._l23_2a-n*t._l12_2a)/i,u=(u*r+t._y1*t._l23_2a-e*t._l12_2a)/i),t._context.bezierCurveTo(a,o,s,u,t._x2,t._y2)}function ca(t,n){this._context=t,this._alpha=n}function fa(t,n){this._context=t,this._alpha=n}function la(t,n){this._context=t,this._alpha=n}function ha(t){return t<0?-1:1}function da(t,n,e){var r=t._x1-t._x0,i=(n-=t._x1,(t._y1-t._y0)/(r||n<0&&-0));return t=(i*n+(e=(e-t._y1)/(n||r<0&&-0))*r)/(r+n),(ha(i)+ha(e))*Math.min(Math.abs(i),Math.abs(e),.5*Math.abs(t))||0}function pa(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function _a(t,n,e){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*n,a-s,o-s*e,a,o)}function ga(t){this._context=t}function ya(t){return t.depth}function va(t,n){return t.sourceLinks.length?t.depth:n-1}function ma(t){return function(){return t}}function ba(t,n){return wa(t.source,n.source)||t.index-n.index}function xa(t,n){return wa(t.target,n.target)||t.index-n.index}function wa(t,n){return t.y0-n.y0}function Ma(t){return t.value}function Ta(t){return t.index}function Aa(t){return t.nodes}function Ea(t){return t.links}function Ca(t,n){if(t=t.get(n))return t;throw new Error("missing: "+n)}function Sa({nodes:t}){for(const n of t){let t=n.y0,e=t;for(const e of n.sourceLinks)e.y0=t+e.width/2,t+=e.width;for(const t of n.targetLinks)t.y1=e+t.width/2,e+=t.width}}function ka(t){return[t.source.x1,t.y0]}function Na(t){return[t.target.x0,t.y1]}function Da(t,n){var e;return(n=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0?null:[1<(e=t.slice(0,n)).length?e[0]+e.slice(2):e,+t.slice(n+1)]}Math.sqrt(1/3),Math.sin(xr/10),Math.sin(7*xr/10),Math.sin(be/10),Math.cos(be/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),ea.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:na(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:na(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},ra.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(0<e)for(var r,i=t[0],a=n[0],o=t[e]-i,s=n[e]-a,u=-1;++u<=e;)this._basis.point(this._beta*t[u]+(1-this._beta)*(i+(r=u/e)*o),this._beta*n[u]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}},function t(n){function e(t){return 1===n?new ea(t):new ra(t,n)}return e.beta=function(n){return t(+n)},e}(.85),aa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ia(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:ia(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}},function t(n){function e(t){return new aa(t,n)}return e.tension=function(n){return t(+n)},e}(0),oa.prototype={areaStart:ta,areaEnd:ta,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:ia(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}},function t(n){function e(t){return new oa(t,n)}return e.tension=function(n){return t(+n)},e}(0),sa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ia(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}},function t(n){function e(t){return new sa(t,n)}return e.tension=function(n){return t(+n)},e}(0),ca.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e,r;switch(t=+t,n=+n,this._point&&(e=this._x2-t,r=this._y2-n,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))),this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:ua(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}},function t(n){function e(t){return n?new ca(t,n):new aa(t,0)}return e.alpha=function(n){return t(+n)},e}(.5),fa.prototype={areaStart:ta,areaEnd:ta,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){var e,r;switch(t=+t,n=+n,this._point&&(e=this._x2-t,r=this._y2-n,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))),this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:ua(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}},function t(n){function e(t){return n?new fa(t,n):new oa(t,0)}return e.alpha=function(n){return t(+n)},e}(.5),la.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e,r;switch(t=+t,n=+n,this._point&&(e=this._x2-t,r=this._y2-n,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))),this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ua(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}},function t(n){function e(t){return n?new la(t,n):new sa(t,0)}return e.alpha=function(n){return t(+n)},e}(.5),ga.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_a(this,this._t0,pa(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,_a(this,pa(this,e=da(this,t,n)),e);break;default:_a(this,this._t0,e=da(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},Object.create(ga.prototype).point=function(t,n){ga.prototype.point.call(this,n,t)},(m=zi=zi||{}).EBONY="#17171A",m.AMARANTO="#2C3B4A",m.WALNUT="#687782",m.TEAL="#86939B",m.IPE="#ABB3B9",m.HICKORY="#C7CDD1",m.ASH="#E0E1E2",m.MAPLE="#F5F5F5",m.PINE="#FAFAFA",m.WHITE="#FFFFFF",(at=ji=ji||{}).BLUE="#668CB2",at.GREEN="#62B578",at.PINK="#F17272",at.RED="#D80D0D",at.ORANGE="#FCB61D",at.YELLOW="#FFC437",at.PURPLE="#7A6199",(it=Xi=Xi||{}).HIGHLIGHT="#F1F5F9",it.HIGHLIGHT16="#E7EDF3",it.HIGHLIGHT32="#CEDAE6";var La,Pa=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ua(t){var n;if(n=Pa.exec(t))return new Oa({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]});throw new Error("invalid format: "+t)}function Oa(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Ha(t,n){var e;return(n=Da(t,n))?(e=n[0],(n=n[1])<0?"0."+new Array(-n).join("0")+e:e.length>n+1?e.slice(0,n+1)+"."+e.slice(n+1):e+new Array(n-e.length+2).join("0")):t+""}Ua.prototype=Oa.prototype,Oa.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Ra={"%":(t,n)=>(100*t).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return 1e21<=Math.abs(t=Math.round(t))?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>Ha(100*t,n),r:Ha,s:function(t,n){var e,r,i=Da(t,n);return i?(e=i[0],(i=(i=i[1])-(La=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1)===(r=e.length)?e:r<i?e+new Array(i-r+1).join("0"):0<i?e.slice(0,i)+"."+e.slice(i):"0."+new Array(1-i).join("0")+Da(t,Math.max(0,n+i-1))[0]):t+""},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Fa(t){return t}var Ia=Array.prototype.map,Ya=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],Ba=(xr=function(t){var n,e,r,i=void 0===t.grouping||void 0===t.thousands?Fa:(e=Ia.call(t.grouping,Number),r=t.thousands+"",function(t,n){for(var i=t.length,a=[],o=0,s=e[0],u=0;0<i&&0<s&&(n<u+s+1&&(s=Math.max(1,n-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(r)}),a=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?Fa:(n=Ia.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,(function(t){return n[+t]}))}),c=void 0===t.percent?"%":t.percent+"",f=void 0===t.minus?"−":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var n=(t=Ua(t)).fill,e=t.align,r=t.sign,h=t.symbol,d=t.zero,p=t.width,_=t.comma,g=t.precision,y=t.trim,v=t.type,m=("n"===v?(_=!0,v="g"):Ra[v]||(void 0===g&&(g=12),y=!0,v="g"),(d||"0"===n&&"="===e)&&(d=!0,n="0",e="="),"$"===h?a:"#"===h&&/[boxX]/.test(v)?"0"+v.toLowerCase():""),b="$"===h?o:/[%p]/.test(v)?c:"",x=Ra[v],w=/[defgprs%]/.test(v);function M(t){var a,o,c,h=m,M=b;if("c"===v)M=x(t)+M,t="";else{var T=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:x(Math.abs(t),g),y&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(!+t[r])break t;0<i&&(i=0)}return 0<i?t.slice(0,i)+t.slice(n+1):t}(t)),h=((T=(!T||0!=+t||"+"===r)&&T)?"("===r?r:f:"-"===r||"("===r?"":r)+h,M=("s"===v?Ya[8+La/3]:"")+M+(T&&"("===r?")":""),w)for(a=-1,o=t.length;++a<o;)if((c=t.charCodeAt(a))<48||57<c){M=(46===c?s+t.slice(a+1):t.slice(a))+M,t=t.slice(0,a);break}}_&&!d&&(t=i(t,1/0));var A=h.length+t.length+M.length,E=A<p?new Array(p-A+1).join(n):"";switch(_&&d&&(t=i(E+t,E.length?p-M.length:1/0),E=""),e){case"<":t=h+t+M+E;break;case"=":t=h+E+t+M;break;case"^":t=E.slice(0,A=E.length>>1)+h+t+M+E.slice(A);break;default:t=E+h+t+M}return u(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),M.toString=function(){return t+""},M}return{format:h,formatPrefix:function(t,n){var e=h(((t=Ua(t)).type="f",t)),r=(n=3*Math.max(-8,Math.min(8,Math.floor((t=n,((t=Da(Math.abs(t)))?t[1]:NaN)/3)))),Math.pow(10,-n)),i=Ya[8+n/3];return function(t){return e(r*t)+i}}}}({thousands:",",grouping:[3],currency:["$",""]})).format;function qa(t,n){void 0===n&&(n="*");var e=null==(e=null===window||void 0===window?void 0:window.parent)?void 0:e.parent;e?e.postMessage(t,n):console.error("Error posting the following message - could not find grandparent window:",t)}function Ga(t){return eo.includes(t)}xr.formatPrefix,(be=za=za||{}).TARGET_MATCH="TARGET_MATCH",be.CREATIVE_MATCH="CREATIVE_MATCH",be.BIDDING_AGENT="BIDDING_AGENT",be.FREQUENCY_CAP="FREQUENCY_CAP",be.BUDGET="BUDGET",be.PACING="PACING",be.POST_PROCESSING="POST_PROCESSING",be.BID_OK="BID_OK",(m=ja=ja||{}).CLEAR_SELECTED_DROP_STAGE="CLEAR_SELECTED_DROP_STAGE",m.CUSTOM_VIS_HANDSHAKE="CUSTOM_VIS_HANDSHAKE",m.HIDE_DONUT_CHART="HIDE_DONUT_CHART",m.SET_DROP_STAGE="SET_DROP_STAGE",(at=Xa=Xa||{}).DONUT_CHART="DONUT_CHART",at.SANKEY_CHART="SANKEY_CHART";var za,ja,Xa,Va=["M2.34315 2.40249L3.75736 0.988281L13.6569 10.8878L12.2426 12.302L2.34315 2.40249Z","M2.28177 4.46304C1.59269 5.19107 1.04054 6.05047 0.666504 6.99963C1.81984 9.92629 4.6665 11.9996 7.99984 11.9996C8.56442 11.9996 9.11505 11.9401 9.64585 11.8271L8.14844 10.3297C8.09917 10.3319 8.04963 10.333 7.99984 10.333C6.15984 10.333 4.6665 8.83963 4.6665 6.99963C4.6665 6.94983 4.6676 6.90029 4.66976 6.85103L2.28177 4.46304Z","M8.78174 8.84168L6.15778 6.21773C6.43428 5.5652 7.0469 5.09124 7.77999 5.01151L9.98796 7.21948C9.90823 7.95256 9.43426 8.56519 8.78174 8.84168Z","M9.76642 9.82637L11.2423 11.3023C11.8721 11.0169 12.4578 10.651 12.9862 10.2177L11.0693 8.30085C10.8008 8.93296 10.3427 9.46531 9.76642 9.82637Z","M11.2769 6.38714L14.051 9.16123C14.5862 8.51906 15.0215 7.7905 15.3332 6.99963C14.1798 4.07296 11.3332 1.99963 7.99984 1.99963C7.64656 1.99963 7.29875 2.02292 6.95784 2.06804L8.61232 3.72252C9.96155 3.97343 11.026 5.03791 11.2769 6.38714Z","M6.69861 3.93013C6.0665 4.19865 5.53416 4.6568 5.17309 5.23304L3.41401 3.47396C3.97792 3.06882 4.59742 2.73639 5.2589 2.49042L6.69861 3.93013Z"],Za="M7.99984 0C4.6665 0 1.81984 2.07333 0.666504 5C1.81984 7.92667 4.6665 10 7.99984 10C11.3332 10 14.1798 7.92667 15.3332 5C14.1798 2.07333 11.3332 0 7.99984 0ZM7.99984 8.33333C6.15984 8.33333 4.6665 6.84 4.6665 5C4.6665 3.16 6.15984 1.66667 7.99984 1.66667C9.83984 1.66667 11.3332 3.16 11.3332 5C11.3332 6.84 9.83984 8.33333 7.99984 8.33333ZM7.99984 3C6.89317 3 5.99984 3.89333 5.99984 5C5.99984 6.10667 6.89317 7 7.99984 7C9.1065 7 9.99984 6.10667 9.99984 5C9.99984 3.89333 9.1065 3 7.99984 3Z",$a=((xr={})[za.TARGET_MATCH]={failure:"No Targeting Match",success:"Targeting Match"},xr[za.CREATIVE_MATCH]={failure:"No Creative Match",success:"Creative Match"},xr[za.BIDDING_AGENT]={failure:"Bid Strategy Fails",success:"Bid Strategy Passes"},xr[za.FREQUENCY_CAP]={failure:"Frequency Cap Met",success:"Under Frequency Cap"},xr[za.BUDGET]={failure:"Budget Cap Met",success:"Under Budget"},xr[za.PACING]={failure:"No Bid to Pace",success:"Passed Pacing"},xr[za.POST_PROCESSING]={failure:"Post Processing Fails",success:"Post Processing Passes"},xr[za.BID_OK]={failure:"Did Not Bid",success:"Bid Successful"},xr),Wa=["Did Not Bid","Bid Successful"],Ka={type:ja.HIDE_DONUT_CHART},Qa=(be=Object.values($a).map((function(t){return t.failure})),m=Object.values($a).map((function(t){return t.success})),function(t,n,e){if(e||2===arguments.length)for(var r,i=0,a=n.length;i<a;i++)!r&&i in n||((r=r||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(r||Array.prototype.slice.call(n))}),Ja={type:ja.CUSTOM_VIS_HANDSHAKE,payload:Xa.SANKEY_CHART},to=_t(ji.GREEN),no=_t(ji.RED),eo=(at=[za.TARGET_MATCH,za.POST_PROCESSING]).map((function(t){return $a[t].failure})),ro=at.reduce((function(t,n){return t[$a[n].failure]=n,t}),{}),io=new Set(be),ao=new Set(m),oo={id:"sankey",label:"Sankey",options:{hiddenDimensions:{type:"array",label:"Hidden Dimensions",default:[]},selectedDropStage:{type:"string",label:"Selected Drop Stage",default:za.TARGET_MATCH}},create:function(t){t.style.backgroundColor=zi.PINE,t.innerHTML="\n            <style>\n                @import url(https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,400italic,600italic,700italic&subset=latin);\n\n                .node,\n                .text-box,\n                .link {\n                    transition: 0.5s all;\n                }\n            </style>\n        ",this.svg=Q(t).append("svg"),qa(Ja)},updateAsync:function(t,n,e,a,o,s){var u,c,f,l,h,d,p,_,g,y,v,m,b,x,w,M,T,A,E,C,S,k,N;console.log("[sankey] updateAsync()",{config:e}),function(t,n,e,r){function i(n,e,r,i,a){return!(!t.addError||!t.clearErrors||(r<i?(t.addError({title:"Not Enough ".concat(e,"s"),message:"This visualization requires ".concat(i===a?"exactly":"at least"," ").concat(i," ").concat(e.toLowerCase()).concat(1===i?"":"s","."),group:n}),1):a<r?(t.addError({title:"Too Many ".concat(e,"s"),message:"This visualization requires ".concat(i===a?"exactly":"no more than"," ").concat(a," ").concat(e.toLowerCase()).concat(1===i?"":"s","."),group:n}),1):(t.clearErrors(n),0)))}var a,o=(n=n.fields).pivots,s=n.dimensions;return n=n.measure_like,a="data-req",!(!t.addError||!t.clearErrors||(t.clearErrors(a),0===e.length&&(t.addError({title:"No Data",message:"There is no data to display",group:a}),1)))&&i("pivot-req","Pivot",o.length,r.min_pivots,r.max_pivots)&&i("dim-req","Dimension",s.length,r.min_dimensions,r.max_dimensions)&&i("mes-req","Measure",n.length,r.min_measures,r.max_measures)}(this,a,t,{min_pivots:0,max_pivots:0,min_dimensions:2,max_dimensions:void 0,min_measures:1,max_measures:1})?(this.clearDropStageListener&&window.removeEventListener("message",this.clearDropStageListener),this.clearDropStageListener=function(t){console.log("[sankey] clearDropStageListener()",t),oo.trigger&&t.data.type===ja.CLEAR_SELECTED_DROP_STAGE&&(console.log('[sankey] vis.trigger("updateConfig")',[{selectedDropState:""}]),oo.trigger("updateConfig",[{selectedDropStage:""}]))},window.addEventListener("message",this.clearDropStageListener),u=n.clientWidth,c=n.clientHeight,f=this.svg.html("").attr("width","100%").attr("height","100%").append("g"),l=a.fields.dimension_like.filter((function(t){var n;return!(null!=(n=null==(n=e.hiddenDimensions)?void 0:n.includes(t.name))&&n)})),h=l.slice(0,-1),d=a.fields.measure_like[0],n=f.append("defs"),p="RED_GRADIENT",(a=n.append("linearGradient").attr("id",p).attr("gradientUnits","userSpaceOnUse")).append("stop").attr("class","start").attr("offset","0%").attr("stop-color","#EB8F8F").attr("stop-opacity",1),a.append("stop").attr("class","end").attr("offset","100%").attr("stop-color","#E25454").attr("stop-opacity",1),_="GREEN_RED_GRADIENT",(a=n.append("linearGradient").attr("id",_).attr("gradientUnits","userSpaceOnUse")).append("stop").attr("class","start").attr("offset","0%").attr("stop-color",to).attr("stop-opacity",1),a.append("stop").attr("class","end").attr("offset","100%").attr("stop-color",no).attr("stop-opacity",1),g="BOX_SHADOW",n.append("filter").attr("id",g).append("feDropShadow").attr("dx",0).attr("dy",2).attr("stdDeviation",2).attr("flood-color","rgba(0,0,0,0.16)"),a=function(){let t,n,e,a=0,o=0,s=1,u=1,c=24,f=8,l=Ta,h=va,d=Aa,p=Ea,_=6;function g(){var g,v,m={nodes:d.apply(null,arguments),links:p.apply(null,arguments)},{nodes:x,links:w}=m;for([g,v]of x.entries())v.index=g,v.sourceLinks=[],v.targetLinks=[];var M,T,A=new Map(x.map(((t,n)=>[l(t,n,x),t])));for([M,T]of w.entries()){T.index=M;let{source:t,target:n}=T;"object"!=typeof t&&(t=T.source=Ca(A,t)),"object"!=typeof n&&(n=T.target=Ca(A,n)),t.sourceLinks.push(T),n.targetLinks.push(T)}if(null!=e)for(var{sourceLinks:E,targetLinks:C}of x)E.sort(e),C.sort(e);w=m.nodes;for(const t of w)t.value=void 0===t.fixedValue?Math.max(i(t.sourceLinks,Ma),i(t.targetLinks,Ma)):t.fixedValue;{var S=(w=m.nodes).length;let t=new Set(w),n=new Set,e=0;for(;t.size;){for(const r of t)for(var{target:k}of(r.depth=e,r.sourceLinks))n.add(k);if(++e>S)throw new Error("circular link");t=n,n=new Set}}{var N=(w=m.nodes).length;let t=new Set(w),n=new Set,e=0;for(;t.size;){for(const r of t)for(var{source:D}of(r.height=e,r.targetLinks))n.add(D);if(++e>N)throw new Error("circular link");t=n,n=new Set}}var L=function({nodes:t}){var e=r(t,(t=>t.depth))+1,i=(s-a-c)/(e-1),o=new Array(e);for(const n of t){var u=Math.max(0,Math.min(e-1,Math.floor(h.call(null,n,e))));n.layer=u,n.x0=a+u*i,n.x1=n.x0+c,o[u]?o[u].push(n):o[u]=[n]}if(n)for(const t of o)t.sort(n);return o}(w=m),w=(t=Math.min(f,(u-o)/(r(L,(t=>t.length))-1)),L),P=function(t,n){var e,r,i=t.length,a=-1;if(null==n){for(;++a<i;)if(null!=(e=t[a])&&e<=e)for(r=e;++a<i;)null!=(e=t[a])&&e<r&&(r=e)}else for(;++a<i;)if(null!=(e=n(t[a]))&&e<=e)for(r=e;++a<i;)null!=(e=n(t[a]))&&e<r&&(r=e);return r}(w,(n=>(u-o-(n.length-1)*t)/i(n,Ma)));for(const n of w){let r=o;for(const e of n){e.y0=r,e.y1=r+e.value*P,r=e.y1+t;for(const t of e.sourceLinks)t.width=t.value*P}r=(u-r+t)/(n.length+1);for(let t=0;t<n.length;++t){var U=n[t];U.y0+=r*(t+1),U.y1+=r*(t+1)}!function(t){if(void 0===e)for(var{sourceLinks:n,targetLinks:r}of t)n.sort(xa),r.sort(ba)}(n)}for(let e=0;e<_;++e){var O=Math.pow(.99,e),H=Math.max(1-O,(e+1)/_);!function(e,r,i){for(let c=e.length-2;0<=c;--c){var a,o=e[c];for(const n of o){let e=0,i=0;for(var{target:s,value:u}of n.sourceLinks)u*=s.layer-n.layer,e+=function(n,e){let r=e.y0-(e.targetLinks.length-1)*t/2;for(var{source:i,width:a}of e.targetLinks){if(i===n)break;r+=a+t}for(var{target:o,width:s}of n.sourceLinks){if(o===e)break;r-=s}return r}(n,s)*u,i+=u;0<i&&(a=(e/i-n.y0)*r,n.y0+=a,n.y1+=a,b(n))}void 0===n&&o.sort(wa),y(o,i)}}(L,O,H),function(e,r,i){for(let c=1,f=e.length;c<f;++c){var a,o=e[c];for(const n of o){let e=0,i=0;for(var{source:s,value:u}of n.targetLinks)u*=n.layer-s.layer,e+=function(n,e){let r=n.y0-(n.sourceLinks.length-1)*t/2;for(var{target:i,width:a}of n.sourceLinks){if(i===e)break;r+=a+t}for(var{source:o,width:s}of e.targetLinks){if(o===n)break;r-=s}return r}(s,n)*u,i+=u;0<i&&(a=(e/i-n.y0)*r,n.y0+=a,n.y1+=a,b(n))}void 0===n&&o.sort(wa),y(o,i)}}(L,O,H)}return Sa(m),m}function y(n,e){var r=n.length>>1,i=n[r];m(n,i.y0-t,r-1,e),v(n,i.y1+t,1+r,e),m(n,u,n.length-1,e),v(n,o,0,e)}function v(n,e,r,i){for(;r<n.length;++r){var a=n[r],o=(e-a.y0)*i;1e-6<o&&(a.y0+=o,a.y1+=o),e=a.y1+t}}function m(n,e,r,i){for(;0<=r;--r){var a=n[r],o=(a.y1-e)*i;1e-6<o&&(a.y0-=o,a.y1-=o),e=a.y0-t}}function b({sourceLinks:t,targetLinks:n}){if(void 0===e){for(const{source:{sourceLinks:t}}of n)t.sort(xa);for(const{target:{targetLinks:n}}of t)n.sort(ba)}}return g.update=function(t){return Sa(t),t},g.nodeId=function(t){return arguments.length?(l="function"==typeof t?t:ma(t),g):l},g.nodeAlign=function(t){return arguments.length?(h="function"==typeof t?t:ma(t),g):h},g.nodeSort=function(t){return arguments.length?(n=t,g):n},g.nodeWidth=function(t){return arguments.length?(c=+t,g):c},g.nodePadding=function(n){return arguments.length?(f=t=+n,g):f},g.nodes=function(t){return arguments.length?(d="function"==typeof t?t:ma(t),g):d},g.links=function(t){return arguments.length?(p="function"==typeof t?t:ma(t),g):p},g.linkSort=function(t){return arguments.length?(e=t,g):e},g.size=function(t){return arguments.length?(a=o=0,s=+t[0],u=+t[1],g):[s-a,u-o]},g.extent=function(t){return arguments.length?(a=+t[0][0],s=+t[1][0],o=+t[0][1],u=+t[1][1],g):[[a,o],[s,u]]},g.iterations=function(t){return arguments.length?(_=+t,g):_},g}().nodeAlign(ya).nodeWidth(12).nodePadding(42).extent([[28,20],[u-150,c-40]]),(n=a).nodeSort(null),n.linkSort(null),y=(u-150-28)/h.length,v=function(t){return f.append("rect").attr("x",28+(y-1.8)*t+6-1).attr("y",0).attr("height",c-20).attr("width",2).attr("fill",zi.ASH)},h.forEach((function(t,n){v(n)})),v(h.length),n=f.append("g").attr("class","links").attr("fill","none").attr("stroke","#fff").selectAll("path"),m=f.append("g"),N=f.append("g").attr("class","nodes").attr("font-family","Open Sans, sans-serif").attr("font-size",14).selectAll("g"),b=f.append("g"),k=f.append("g").attr("class","text-boxes").attr("font-family","Open Sans, sans-serif").attr("font-size",14).selectAll("g"),x={nodes:[],links:[]},w=pe(),M=function(t){return Object.values(t).filter((function(t){return ao.has(t.value)})).length},t.sort((function(t,n){return M(t)-M(n)})),t.forEach((function(t,n){var e=l.filter((function(n){return null!==t[n.name].value})).map((function(n){return t[n.name].value}));e.forEach((function(n,r){var i;r!==e.length-1&&(n=n+r+"len:".concat(n.length),i=e[r+1],r=Wa.includes(i)?i:i+(r+1)+"len:".concat(i.length),w.add(n),w.add(r),x.links.push({source:n,target:r,value:+t[d.name].value}))}))})),T=w.values(),x.links.forEach((function(t){t.source=T.indexOf(t.source),t.target=T.indexOf(t.target)})),x.nodes=w.values().map((function(t){return{name:t.slice(0,t.split("len:")[1])}})),a(x),t=n.data(x.links).enter().append("g"),a=function(t){var n=Ki,e=Qi,r=$i,i=Wi,a=null;function o(){var o,s=Vi.call(arguments),u=n.apply(this,s),c=e.apply(this,s);if(a=a||(o=se()),t(a,+r.apply(this,(s[0]=u,s)),+i.apply(this,s),+r.apply(this,(s[0]=c,s)),+i.apply(this,s)),o)return a=null,o+""||null}return o.source=function(t){return arguments.length?(n=t,o):n},o.target=function(t){return arguments.length?(e=t,o):e},o.x=function(t){return arguments.length?(r="function"==typeof t?t:Zi(+t),o):r},o.y=function(t){return arguments.length?(i="function"==typeof t?t:Zi(+t),o):i},o.context=function(t){return arguments.length?(a=null==t?null:t,o):a},o}(Ji).source(ka).target(Na),t.append("path").attr("d",a).attr("stroke-width",(function(t){return Math.max(1,t.width)})).attr("stroke","white").style("opacity",(function(t){return 0===t.width?0:1})),t.append("path").attr("class","link").attr("d",a).attr("stroke-width",(function(t){return Math.max(1,t.width)+.5})).style("opacity",(function(t){return 0===t.width?0:io.has(t.source.name)?1:.05*t.source.depth+.4})).style("stroke",(function(t){return ao.has(t.source.name)&&io.has(t.target.name)?"url(#".concat(_,")"):io.has(t.source.name)?"url(#".concat(p,")"):to})),N=N.data(x.nodes).enter().append("g").attr("class","node"),k=k.data(x.nodes).enter().append("g").attr("class","text-box"),N.append("rect").attr("x",(function(t){return t.x0})).attr("y",(function(t){return t.y0-8})).attr("height",(function(t){return Math.abs(t.y1-t.y0)+16})).attr("width",(function(t){return Math.abs(t.x1-t.x0)})).attr("fill",(function(t){return io.has(t.name)?no:to})).style("opacity",(function(t){return 0===t.value?0:1})).attr("rx",2),h.forEach((function(t,n){var r,i,a=b.append("g");a.append("text").attr("class","column-label").attr("x",28+y*n+y/2).attr("y",c-3).attr("text-anchor","middle").text(t.label_short.toUpperCase()).attr("font-family","Open Sans, sans-serif").attr("font-size",11).attr("font-weight","600").attr("fill",zi.AMARANTO).style("user-select","none"),!n&&2<h.length&&(n=a.append("g").attr("class","hover-group").attr("opacity",0),a.on("mouseover",(function(){Q(this).style("cursor","pointer"),Q(this).select(".hover-group").attr("opacity",1),Q(this).select(".column-label").attr("fill",ji.BLUE)})),a.on("mouseout",(function(){Q(this).style("cursor","default"),Q(this).select(".hover-group").attr("opacity",0),Q(this.parentNode).select(".column-label").attr("fill",zi.AMARANTO)})),a.on("click",(function(){console.log("[sankey] handling hide column (?) click"),q.stopPropagation(),oo.trigger&&(console.log('[sankey] vis.trigger("updateConfig")',[{hiddenDimensions:Qa(Qa([],e.hiddenDimensions,!0),[t.name],!1)}]),oo.trigger("updateConfig",[{hiddenDimensions:Qa(Qa([],e.hiddenDimensions,!0),[t.name],!1)}]))})),n.append("rect").attr("x",28).attr("y",0).attr("height",c-20).attr("width",y+12-2).attr("fill","white").attr("opacity",.4),(r=n.append("g").attr("class","hide-values-label")).append("rect").attr("height",26).attr("width",106).attr("rx",5).attr("fill",zi.EBONY),i=r.append("g").attr("transform","translate(8, 6)"),Va.forEach((function(t){return i.append("path").attr("d",t).attr("fill",zi.MAPLE)})),r.append("text").attr("x",32).attr("y",17).attr("font-weight","400").attr("font-size",12).attr("font-family","Open Sans, sans-serif").attr("fill",zi.MAPLE).attr("user-select","none").text("Hide Values"),a.on("mousemove",(function(){var t=((t=J(a.node()))[0],t[1]-13);r.attr("transform","translate(".concat(28+y/2-53,", ").concat(t,")"))})),a.on("mouseenter",(function(){var t=((t=J(a.node()))[0],t[1]-13);r.attr("transform","translate(".concat(28+y/2-53,", ").concat(t,")"))})))})),null!=(n=null==e?void 0:e.hiddenDimensions)&&n.length&&((t=f.append("g").on("mouseover",(function(){Q(this).style("cursor","pointer"),Q(this).select("rect").attr("fill",Xi.HIGHLIGHT),Q(this).select("path").attr("fill",ji.BLUE),Q(this).select(".show-values-label").attr("opacity",1)})).on("mouseout",(function(){Q(this).style("cursor","default"),Q(this).select("rect").attr("fill",zi.ASH),Q(this).select("path").attr("fill",zi.AMARANTO),Q(this).select(".show-values-label").attr("opacity",0)})).on("click",(function(){var t;console.log("[sankey] handling show more click"),oo.trigger&&(t=e.hiddenDimensions.pop(),console.log("[sankey] triggering updateConfig",{hiddenDimensions:e.hiddenDimensions,popped:t}),oo.trigger("updateConfig",[{hiddenDimensions:e.hiddenDimensions}]))}))).append("rect").attr("x",2).attr("y",12).attr("width",12).attr("height",c-40-4).attr("rx",2).attr("fill",zi.ASH),t.append("path").attr("d",Za).attr("transform","translate(0, ".concat(c-10,")")).attr("fill",zi.AMARANTO),(a=t.append("g").attr("class","show-values-label").attr("transform","translate(".concat(6,", ").concat(c/2-13,")")).attr("opacity",0)).append("rect").attr("height",26).attr("width",104).attr("rx",5).attr("fill",zi.EBONY),a.append("path").attr("d",Za).attr("transform","translate(8, 8)").attr("fill",zi.MAPLE),a.append("text").attr("x",32).attr("y",17).attr("font-weight","400").attr("font-size",12).attr("font-family","Open Sans, sans-serif").attr("fill",zi.MAPLE).attr("user-select","none").text("Show More")),A=function(t){return Ga(t)?32:0},n=(N=k.append("g").style("opacity",(function(t){return 0===t.value?0:1}))).append("rect"),E=function(t){return Wa.includes(t.name)?5:-5},C=function(t){return(t.y1+t.y0)/2},S=function(t){return Wa.includes(t.name)?20:12},N.append("text").attr("x",(function(t){return t.x1+E(t)+8})).attr("y",(function(t){var n=A(t.name);return t=C(t)-n,Math.max(t,30)})).attr("text-anchor","start").attr("font-weight","400").attr("font-size",S).attr("font-family","Open Sans, sans-serif").attr("fill",(function(t){return ro[t.name]===(null==e?void 0:e.selectedDropStage)?zi.WHITE:zi.EBONY})).style("user-select","none").text((function(t){return t.name})),N.append("text").attr("x",(function(t){return t.x1+E(t)+8})).attr("y",(function(t){var n=A(t.name);return t=C(t)+S(t)*(8/6)-n,Math.max(t,46)})).attr("text-anchor","start").attr("font-weight","600").attr("font-size",S).attr("font-family","Open Sans, sans-serif").attr("fill",(function(t){return ro[t.name]===(null==e?void 0:e.selectedDropStage)?zi.WHITE:zi.EBONY})).style("user-select","none").text((function(t){return t=t.value,Ba(".3s")(t).replace(/G/,"B")})),t=function(t){console.log("[sankey] handleShowDetailClick()"),q.stopPropagation(),(t=ro[t.name])===(null==e?void 0:e.selectedDropStage)?(console.log("[sankey] postMessageToGrandparent(HIDE_DONUT_CHART_MSG)",Ka),qa(Ka),oo.trigger&&(console.log('[sankey] vis.trigger("updateConfig",',{selectedDropState:""},");"),oo.trigger("updateConfig",[{selectedDropStage:""}]))):(console.log("[sankey] postMessageToGrandparent({ type, payload })",{type:ja.SET_DROP_STAGE,payload:t}),qa({type:ja.SET_DROP_STAGE,payload:t}),oo.trigger?(console.log('[sankey] vis.trigger("updateConfig",',{selectedDropState:t},");"),oo.trigger("updateConfig",[{selectedDropStage:t}])):console.log("[sankey] vis.trigger not defined"))},(a=N.filter((function(t){return Ga(t.name)}))).append("rect").attr("rx",3).attr("height",20).attr("fill",ji.BLUE).attr("x",(function(t){return t.x1+E(t)+5})).attr("y",(function(t){return t=C(t)-16+13,Math.max(t,59)})).attr("width",(function(){var t=null==(t=null==(t=null==this?void 0:this.parentNode)?void 0:t.children)?void 0:t[1];return(t?t.getComputedTextLength()+16:100)-8})).attr("data-vis","sankey-show-details-group").style("cursor","pointer").on("mouseover",(function(){Q(this).attr("opacity",.9)})).on("mouseout",(function(){Q(this).attr("opacity",1)})).on("click",t),a.append("text").attr("x",(function(t){var n=(n=null==(n=null==(n=null==this?void 0:this.parentNode)?void 0:n.children)?void 0:n[1])?n.getComputedTextLength()+16:100;return t.x1+n/2-4})).attr("y",(function(t){return t=C(t)-16+26.5,Math.max(t,71.5)})).attr("font-size","10px").attr("text-anchor","middle").attr("data-vis","sankey-show-details-group-text").attr("fill",zi.WHITE).attr("font-family","Open Sans, sans-serif").style("cursor","pointer").style("user-select","none").on("mouseover",(function(){var t;Q(null==(t=null==this?void 0:this.parentNode)?void 0:t.children[3]).attr("opacity",.9)})).on("mouseout",(function(){var t;Q(null==(t=null==this?void 0:this.parentNode)?void 0:t.children[3]).attr("opacity",1)})).on("click",t).text((function(t){return t=ro[t.name]===(null==e?void 0:e.selectedDropStage)?"Hide":"Show","".concat(t," Details")})),N.append("text").attr("x",(function(t){var n;return Wa.includes(t.name)?u:((n=null==(n=null==(n=null==this?void 0:this.parentNode)?void 0:n.children)?void 0:n[1])?n.getComputedTextLength()+8:100)+t.x1+E(t)})).attr("y",(function(t){var n=A(t.name);return t=C(t)+S(t)*(8/6)-n,Math.max(t,46)})).attr("text-anchor","end").attr("font-weight","600").attr("font-size",12).attr("font-family","Open Sans, sans-serif").attr("fill",(function(t){return Wa.includes(t.name)?t.name===$a.BID_OK.success?ji.GREEN:ji.RED:ro[t.name]===(null==e?void 0:e.selectedDropStage)?zi.WHITE:zi.AMARANTO})).style("user-select","none").text((function(t){var n=t.depth,e=null!=(e=null==(e=x.nodes.find((function(e){return e.depth===n&&e.name!==t.name})))?void 0:e.value)?e:0,r=(e=100*t.value/(t.value+e),Math.round(e));return e=e!==r?"~":"",0===r&&(e="<",r=1),"".concat(e).concat(r,"%")})),n.attr("x",(function(t){return t.x1+E(t)})).attr("y",(function(t){var n=A(t.name);return t=C(t)-16-n,Math.max(t,14)})).attr("width",(function(){var t=null==(t=null==(t=null==this?void 0:this.parentNode)?void 0:t.children)?void 0:t[1];return(t?t.getComputedTextLength()+16:100)+3})).attr("height",(function(t){return Ga(t.name)?"72px":"40px"})).attr("rx",3).attr("fill",(function(t){return Wa.includes(t.name)?"transparent":ro[t.name]===(null==e?void 0:e.selectedDropStage)?zi.AMARANTO:zi.MAPLE})).attr("opacity",(function(t){return ro[t.name]===(null==e?void 0:e.selectedDropStage)?1:.8})).attr("filter",(function(t){return Wa.includes(t.name)?null:"url(#".concat(g,")")})),k=x.links.map((function(t){return t.source.x0})).sort((function(t,n){return n<t})),t=(a=x.links.map((function(t){return t.target.x1})).sort((function(t,n){return n<t})))[a.length-1],N=f.node().getBBox().width,n=k[0],a=N-t,m.append("rect").attr("x",0).attr("y",0).attr("width",n).attr("height",c).attr("fill",zi.PINE),m.append("rect").attr("x",t).attr("y",0).attr("width",a).attr("height",c).attr("fill",zi.PINE),s()):(s(),console.log("[sankey] updateAsync() early return"))}};return looker.plugins.visualizations.add(oo),n})()));